<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Checkpoint-2</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #3D7B7B; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #F00 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666 } /* Operator */
.codehilite .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #9C6500 } /* Comment.Preproc */
.codehilite .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.codehilite .gr { color: #E40000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #008400 } /* Generic.Inserted */
.codehilite .go { color: #717171 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #04D } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #687822 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #00F; font-weight: bold } /* Name.Class */
.codehilite .no { color: #800 } /* Name.Constant */
.codehilite .nd { color: #A2F } /* Name.Decorator */
.codehilite .ni { color: #717171; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #00F } /* Name.Function */
.codehilite .nl { color: #767600 } /* Name.Label */
.codehilite .nn { color: #00F; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #A2F; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #BBB } /* Text.Whitespace */
.codehilite .mb { color: #666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666 } /* Literal.Number.Float */
.codehilite .mh { color: #666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #A45A77 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #00F } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666 } /* Literal.Number.Integer.Long */

</style>
<style>
    :root {
  --bg: #ffffff;
  --fg: #222222;
  --muted: #555555;
  --border: #e0e0e0;
  --accent: #005fcc;
  --code-bg: #f6f8fa;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
html.dark {
  --bg: #0b0b0b;
  --fg: #e8e8e8;
  --muted: #a0a0a0;
  --border: #333333;
  --accent: #3b82f6;
  --code-bg: #111827;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
* {
  box-sizing: border-box;
}
body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu, "Helvetica Neue", sans-serif;
  line-height: 1.6;
}
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 1.25rem;
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  background: var(--bg);
  z-index: 10;
}
h1 {
  margin: 0;
  font-size: 1.1rem;
}
.tabs {
  display: flex;
  gap: 0.5rem;
}
.tab {
  padding: 0.4rem 0.8rem;
  border: 1px solid var(--border);
  border-bottom: none;
  background: transparent;
  cursor: pointer;
  border-radius: 6px 6px 0 0;
  color: var(--fg);
}
.tab.active {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}
.tab-content {
  display: none;
  padding: 1rem 1.25rem;
  border-top: 1px solid var(--border);
}
.tab-content.active {
  display: block;
}
#theme-toggle {
  border: 1px solid var(--border);
  padding: 0.2rem 0.6rem;
  font-size: 0.9rem;
  border-radius: 4px;
  cursor: pointer;
  background: transparent;
  color: var(--fg);
}
.main {
  max-width: 1200px;
  margin: 0 auto;
}
.message {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.message .meta {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  margin-bottom: 0.6rem;
  color: var(--muted);
  font-size: 0.85rem;
}
.message .badge {
  font-weight: 600;
}
.role-user {
  border-left-color: var(--role-user);
}
.role-assistant {
  border-left-color: var(--role-assistant);
}
.role-system {
  border-left-color: var(--role-system);
}
.role-unknown {
  border-left-color: var(--accent);
}

.output-code-container {
  display: flex;
  gap: 1rem;               /* space between children */
  align-items: center;     /* vertical alignment */
  justify-content: start;  /* horizontal alignment */
}

.output-code-container .codeblock {
  flex: 0 1 auto;
}

.codeblock {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.codeblock-content {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}

.codeblock.eval_code {
  border-left-color: var(--role-user);
}
.codeblock.target_code {
  border-left-color: var(--role-assistant);
}
.codeblock.output_code {
  border-left-color: var(--role-system);
}

html.dark .codeblock-content {
  background: rgba(255,255,255,0.03);
}
.codeblock > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.codeblock > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.codeblock > summary::before {
  content: "▶ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.codeblock[open] > summary::before {
  transform: rotate(90deg);
}
.codeblock .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}

.markdown-body pre code {
  background: var(--code-bg);
  display: block;
  padding: 0.75rem;
  overflow-x: auto;
  border-radius: 4px;
  border: 1px solid var(--border);
}
.markdown-body code {
  background: var(--code-bg);
  padding: 0.15rem 0.3rem;
  border-radius: 4px;
}
/* Extra info tree */
details > summary {
  cursor: pointer;
  font-weight: 600;
}
details .block {
  padding-left: 1rem;
  margin: 0.25rem 0 0.5rem 0;
  border-left: 2px solid var(--border);
}
.kv .key {
  font-weight: 600;
}
.kv .type {
  color: var(--muted);
  margin-left: 0.5rem;
  font-size: 0.85rem;
}
footer {
  margin: 2rem 0;
  text-align: center;
  color: var(--muted);
  font-size: 0.85rem;
}
/* CodeHilite (pygments) overrides to respect theme vars */
.codehilite {
  background: var(--code-bg) !important;
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.75rem !important;
}
.reasoning {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}
html.dark .reasoning {
  background: rgba(255,255,255,0.03);
}
.reasoning > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.reasoning > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.reasoning > summary::before {
  content: "▶ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.reasoning[open] > summary::before {
  transform: rotate(90deg);
}
.reasoning .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}
.reasoning-body {
  margin-top: 0.5rem;
}
</style>

<!-- ===== MATHJAX CONFIG ===== -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ["\\(","\\)"] ],
    displayMath: [ ["\\[","\\]"] ],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    ignoreHtmlClass: ".*",
    processHtmlClass: "arithmatex"

    // skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    // if you dynamically add content later, you can call MathJax.typesetPromise()
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<!-- ========================== -->
</head>
<body>
<header>
  <h1>Checkpoint-2</h1>
  <div>
    <button id="theme-toggle" aria-label="toggle dark mode">🌓</button>
  </div>
</header>

<div class="main">
  
<article class="message role-system">
    <div class="meta">
        <span class="badge">System</span>
        <span class="idx">#0</span>
    </div>
    <div class="content markdown-body"><p>You are a physics research assistant specializing in solving complex, research-level problems using precise, step-by-step reasoning.</p>
<p><strong>Input</strong>
Problems will be provided in Markdown format.</p>
<p><strong>Output (Markdown format)</strong></p>
<ol>
<li><strong>Step-by-Step Derivation</strong> - Show every non-trivial step in the solution.  Justify steps using relevant physical laws, theorems, or mathematical identities.</li>
<li><strong>Mathematical Typesetting</strong> - Use LaTeX for all mathematics:  <code>$...$</code> for inline expressions, <code>$$...$$</code> for display equations.</li>
<li><strong>Conventions and Units</strong> - Follow the unit system and conventions specified in the problem.</li>
<li>
<p><strong>Final Answer</strong> - At the end of the solution,  start a new line with <strong>&ldquo;Final Answer:&rdquo;</strong>, and present the final result.</p>
<p>For final answers involving values, follow the precision requirements specified in the problem.
If no precision is specified:
- If an exact value is possible, provide it (e.g., \$\sqrt(2)\$, \$\pi/4\$).
- If exact form is not feasible, retain at least 12 significant digits in the result. </p>
</li>
<li>
<p><strong>Formatting Compliance</strong> - If the user requests a specific output format (e.g., code, table),  provide the final answer accordingly.</p>
</li>
</ol></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#1</span>
    </div>
    <div class="content markdown-body"><h1 id="problem-setup">Problem setup:</h1>
<p>In quantum error correction, you encode quantum states into logical states made of many qubits in order to improve their resilience to errors. In quantum error detection, you do the same but can only detect the presence of errors and not correct them. In this problem, we will consider a single [[4,2,2]] quantum error detection code, which encodes two logical qubits into four physical qubits, and investigate how robust logical quantum operations in this code are to quantum errors.</p>
<p>Our convention is that the four physical qubits in the [[4,2,2]] code are labelled 0,1,2,3. The two logical qubits are labelled A and B. The stabilizers are <span class="arithmatex">\(XXXX\)</span> and <span class="arithmatex">\(ZZZZ\)</span>, where <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> are Pauli matrices. The logical <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> operators on the two qubits are <span class="arithmatex">\(X_A = XIXI\)</span>, <span class="arithmatex">\(X_B=XXII\)</span>, <span class="arithmatex">\(Z_A = ZZII\)</span>, <span class="arithmatex">\(Z_B = ZIZI\)</span>, up to multiplication by stabilizers.</p>
<p>We will consider different state preparation circuits consisting of controlled not <span class="arithmatex">\(CNOT_{ij}\)</span> gates, where <span class="arithmatex">\(CNOT_{ij}\)</span> has control qubit <span class="arithmatex">\(i\)</span> and target qubit <span class="arithmatex">\(j\)</span>. As a simple model of quantum errors in hardware, we will suppose that each <span class="arithmatex">\(CNOT_{ij}\)</span> gate in the circuit has a two qubit depolarizing error channel following it that produces one of the 15 non-identity two-qubit Paulis with equal probability <span class="arithmatex">\(p/15\)</span>. The probability <span class="arithmatex">\(p\)</span> indicates the probability of an error in a single two-qubit gate. We will assess the logical infidelity of certain state preparation protocols as a function of the physical infidelity <span class="arithmatex">\(p\)</span>.</p>
<h1 id="subproblems">Checkpoints</h1>
<h2 id="subproblem-1">Checkpoint 1</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the physical state fidelity of the final physical 4-qubit state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#2</span>
    </div>
    <div class="content markdown-body"><p><strong>Solution</strong></p>
<p>We wish to prepare the logical GHZ state  </p>
<div class="arithmatex">\[
\bigl(|00\&gt;\_{AB}+|11\&gt;\_{AB}\bigr)/\sqrt2
\]</div>
<p>in the [[4,2,2]] code by the circuit</p>
<div class="arithmatex">\[
\bigl(CNOT_{03}\bigr)\,\bigl(H_0\bigr)\,\bigl(CNOT_{21}\bigr)\,\bigl(H_2\bigr)
\]</div>
<p>acting on the physical initial state <span class="arithmatex">\(|0000\&gt;\)</span>.  Between each <span class="arithmatex">\(CNOT\)</span> and the next gate, we insert the two‐qubit depolarizing channel on its two qubit support.</p>
<hr />
<h3 id="1-twoqubit-depolarizing-channel">1. Two‐qubit depolarizing channel</h3>
<p>On qubits <span class="arithmatex">\((i,j)\)</span>, the error channel after <span class="arithmatex">\(CNOT_{ij}\)</span> is</p>
<div class="arithmatex">\[
\mathcal D_{ij}(\rho)
  \;=\;(1-p)\,\rho
      \;+\;\frac p{15}\sum_{\substack{P\in\{I,X,Y,Z\}^{\!\otimes2}\\P\neq I\otimes I}}
              \bigl(P_{ij}\,\rho\,P_{ij}^\dagger\bigr)\,,
\]</div>
<p>where <span class="arithmatex">\(p\)</span> is the gate’s “error probability.”</p>
<hr />
<h3 id="2-ideal-intermediate-state-after-h_2-and-cnot_21">2. Ideal intermediate state after <span class="arithmatex">\(H_2\)</span> and <span class="arithmatex">\(CNOT_{21}\)</span></h3>
<p>Start with <span class="arithmatex">\(\rho_0=|0000\&gt;\&lt;0000|\)</span>.  Apply</p>
<div class="arithmatex">\[
H_2:\;|0\&gt;_2\mapsto\frac{|0\&gt;+|1\&gt;}{\sqrt2}, 
\qquad
CNOT_{21}:\;|x\&gt;_2|y\&gt;_1\mapsto|x\&gt;_2\,|y\oplus x\&gt;_1.
\]</div>
<p>One finds the pure state</p>
<div class="arithmatex">\[
|\psi_2\&gt;
\;=\;
\frac1{\sqrt2}\bigl(|0000\&gt;+|0110\&gt;\bigr)
\;=\;
|00\&gt;_{0,3}\;\otimes\;\frac{|00\&gt;+|11\&gt;}{\sqrt2}_{1,2}.
\]</div>
<p>In particular, qubits <span class="arithmatex">\(1,2\)</span> carry the 2‐qubit GHZ state
<span class="arithmatex">\(\bigl(|00\&gt;+|11\&gt;\bigr)/\sqrt2\)</span>, while qubits <span class="arithmatex">\(0,3\)</span> remain in <span class="arithmatex">\(|00\&gt;\)</span>.</p>
<hr />
<h3 id="3-fidelity-loss-from-the-first-depolarizing-channel">3. Fidelity loss from the first depolarizing channel</h3>
<p>We now apply <span class="arithmatex">\(\mathcal D_{21}\)</span> on qubits <span class="arithmatex">\((2,1)\)</span>.  Denote</p>
<div class="arithmatex">\[
\rho_3=\mathcal D_{21}(|\psi_2\&gt;\&lt;\psi_2|).
\]</div>
<p>The fidelity with the ideal <span class="arithmatex">\(|\psi_2\&gt;\)</span> is</p>
<div class="arithmatex">\[
F_1
=\&lt;\psi_2|\rho_3|\psi_2\&gt;
=(1-p)\;+\;\frac p{15}
  \sum_{P\neq I\otimes I}\bigl|\&lt;\psi_2|\,P_{21}\otimes I_{0,3}\,|\psi_2\&gt;\bigr|^2.
\]</div>
<p>But on the GHZ <span class="arithmatex">\(\tfrac{|00\&gt;+|11\&gt;}{\sqrt2}\)</span> of qubits <span class="arithmatex">\((1,2)\)</span>, exactly three non‐identity two‐qubit Paulis preserve the state (namely <span class="arithmatex">\(X\otimes X,\;Y\otimes Y,\;Z\otimes Z\)</span>), each giving overlap magnitude 1, while all others give zero overlap.  Hence</p>
<div class="arithmatex">\[
\sum_{P\neq I\otimes I}\bigl|\&lt;\psi_2|P_{21}|\psi_2\&gt;\bigr|^2
=3,
\]</div>
<p>and</p>
<div class="arithmatex">\[
F_1
=(1-p)+\frac p{15}\,3
=1-p+\frac p5
=1-\frac{4p}5.
\]</div>
<hr />
<h3 id="4-remaining-gates-and-second-depolarizing-channel">4. Remaining gates and second depolarizing channel</h3>
<p>Next we apply the noiseless gates <span class="arithmatex">\(H_0\)</span> and <span class="arithmatex">\(CNOT_{03}\)</span>.  Since these unitaries act only on qubits <span class="arithmatex">\((0,3)\)</span>, they leave the (noisy) reduced state on <span class="arithmatex">\((1,2)\)</span> unchanged and moreover map the ideal target to</p>
<div class="arithmatex">\[
|\psi_{\rm id}\&gt;
\;=\;
\frac1{2}
\Bigl(|0000\&gt;+|0110\&gt;+|1001\&gt;+|1111\&gt;\Bigr)
\;=\;
\frac{|00\&gt;+|11\&gt;}{\sqrt2}_{1,2}
\;\otimes\;
\frac{|00\&gt;+|11\&gt;}{\sqrt2}_{0,3}.
\]</div>
<p>Thus the final pure target factorizes into a GHZ on <span class="arithmatex">\((1,2)\)</span> times a GHZ on <span class="arithmatex">\((0,3)\)</span>.  We then apply <span class="arithmatex">\(\mathcal D_{03}\)</span> on qubits <span class="arithmatex">\((0,3)\)</span>.  By exactly the same argument as above, this second depolarizing channel reduces the fidelity of the <span class="arithmatex">\((0,3)\)</span>‐GHZ by the same factor</p>
<div class="arithmatex">\[
F_2
=1-\frac{4p}5.
\]</div>
<hr />
<h3 id="5-final-physical-fidelity">5. Final physical fidelity</h3>
<p>Because</p>
<ol>
<li>the first noisy channel acted only on qubits <span class="arithmatex">\((1,2)\)</span> preparing the <span class="arithmatex">\((1,2)\)</span>‐GHZ,</li>
<li>after that the state factorized across the two pairs,</li>
<li>the final channel acted only on the disjoint pair <span class="arithmatex">\((0,3)\)</span>,</li>
<li>and unitaries in between do not change state fidelity,</li>
</ol>
<p>the overall fidelity is simply the product</p>
<div class="arithmatex">\[
F_{\rm phys}(p)
\;=\;F_1\,F_2
\;=\;\Bigl(1-\tfrac{4p}5\Bigr)\!\times\!\Bigl(1-\tfrac{4p}5\Bigr)
\;=\;\Bigl(1-\tfrac{4p}5\Bigr)^2.
\]</div>
<p><strong>Final Answer:</strong>  </p>
<div class="arithmatex">\[
\boxed{F_{\rm phys}(p)=\Bigl(1-\tfrac{4p}{5}\Bigr)^2}.
\]</div></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#3</span>
    </div>
    <div class="content markdown-body"><p>The correct answer is:
$
F_{\rm{physical}}=(1-\frac{12}{15}p)^2
$</p>
<p>Now let&rsquo;s solve the next Checkpoint.</p>
<h2 id="subproblem-2">Checkpoint 2</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the logical state fidelity of the final 2-qubit logical state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>, assuming the state is post-selected on all detectable errors in the code?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#4</span>
    </div>
    <div class="content markdown-body"><p><strong>Step-by-Step Derivation</strong></p>
<p>We wish to prepare the logical two-qubit GHZ state </p>
<div class="arithmatex">\[
\lvert\psi_L\&gt;=\frac{\lvert00\&gt;_{AB}+\lvert11\&gt;_{AB}}{\sqrt2}
\]</div>
<p>in the <span class="arithmatex">\([[4,2,2]]\)</span> code via</p>
<div class="arithmatex">\[
\bigl(CNOT_{03}\bigr)\;\bigl(H_0\bigr)\;\bigl(CNOT_{21}\bigr)\;\bigl(H_2\bigr)
\]</div>
<p>with two independent two-qubit depolarizing errors (rate <span class="arithmatex">\(p\)</span>) acting 
immediately after each CNOT.  We then measure the two stabilizers 
<span class="arithmatex">\(\;S_X=X^{\otimes4},\;S_Z=Z^{\otimes4}\)</span>, post-select on the “<span class="arithmatex">\(+1,+1\)</span>” outcome, 
and ask for the fidelity of the <em>logical</em> 2-qubit state (i.e.\ the overlap with <span class="arithmatex">\(\lvert\psi_L\&gt;\)</span>) in that post-selected ensemble.</p>
<hr />
<ol>
<li><strong>Error model and final error operator</strong><br />
   • After <span class="arithmatex">\(CNOT_{21}\)</span> an error <span class="arithmatex">\(E_{21}\in\{I\otimes I,P\}/\{P\neq I\}\)</span> occurs on qubits <span class="arithmatex">\((2,1)\)</span>, with</li>
</ol>
<div class="arithmatex">\[
     \Pr[E_{21}=I\otimes I]=1-p,\quad
     \Pr[E_{21}=P]=\frac p{15}\;(P\neq I\otimes I).
\]</div>
<p>• After <span class="arithmatex">\(CNOT_{03}\)</span> an <em>independent</em> error <span class="arithmatex">\(E_{03}\)</span> of the same form acts on qubits <span class="arithmatex">\((0,3)\)</span>.<br />
   • Because all intervening gates either act on <span class="arithmatex">\((0,3)\)</span> or on <span class="arithmatex">\((2,1)\)</span>, the two errors commute and never spread between the two pairs.  Hence the <em>total</em> physical error on the final codeword is</p>
<div class="arithmatex">\[
     E \;=\; E_{03}\,\otimes\,E_{21}\,,
\]</div>
<p>acting on disjoint qubit‐pairs <span class="arithmatex">\((0,3)\)</span> and <span class="arithmatex">\((2,1)\)</span>.</p>
<ol start="2">
<li><strong>Post-selection condition (“undetectable” errors)</strong><br />
   We measure <span class="arithmatex">\(S_X=X^{\otimes4},\;S_Z=Z^{\otimes4}\)</span> on the <em>final</em> 4-qubit state and keep only the “<span class="arithmatex">\(+1,+1\)</span>” outcomes.  Equivalently, we keep only those Pauli errors <span class="arithmatex">\(E\)</span> which <em>commute</em> with both <span class="arithmatex">\(S_X\)</span> and <span class="arithmatex">\(S_Z\)</span>.  The set of all Pauli operators that commute with every stabilizer is the <em>normalizer</em> <span class="arithmatex">\(N\)</span>.  Among these, the <em>stabilizer subgroup</em> <span class="arithmatex">\(S\subset N\)</span> acts trivially on the code space (i.e.\ no logical error), while the remaining <span class="arithmatex">\(N\setminus S\)</span> are non-trivial logical errors.  </li>
</ol>
<p>Thus, if we let</p>
<div class="arithmatex">\[
     \mathcal{P}_2=\{\,\text{all 2-qubit Paulis}\}
     \quad\text{and}\quad
     q(P)=
     \begin{cases}
       1-p,&amp;P=I\otimes I,\\
       \tfrac p{15},&amp;P\neq I\otimes I,
     \end{cases}
\]</div>
<p>then the joint law is <span class="arithmatex">\(\Pr[E_{21}=P_{21},E_{03}=P_{03}]=q(P_{21})\,q(P_{03})\)</span>.  We define</p>
<p>• Denominator (probability <em>undetected</em>):  </p>
<div class="arithmatex">\[
       D
       =\sum_{\substack{P_{21},P_{03}\\(P_{21}\otimes P_{03})\in N}}
         q(P_{21})\,q(P_{03})\,.
\]</div>
<p>• Numerator (probability <em>undetected</em> &amp; <em>no logical error</em>):  </p>
<div class="arithmatex">\[
       N
       =\sum_{\substack{P_{21},P_{03}\\(P_{21}\otimes P_{03})\in S}}
         q(P_{21})\,q(P_{03})\,.
\]</div>
<p>Then the <em>logical</em> fidelity (post-selected on no syndrome) is</p>
<div class="arithmatex">\[
     F_{\rm logical}
     =\frac{N}{D}\,.
\]</div>
<ol start="3">
<li><strong>Characterizing <span class="arithmatex">\(N\)</span> vs.\ <span class="arithmatex">\(S\)</span> for disjoint pairs</strong><br />
   The stabilizer group of the <span class="arithmatex">\([[4,2,2]]\)</span> code is generated by</li>
</ol>
<div class="arithmatex">\[
     S_X = X_0X_1X_2X_3,\qquad
     S_Z = Z_0Z_1Z_2Z_3,
\]</div>
<p>and has four elements
   <span class="arithmatex">\(\{I,\,X^{\otimes4},\,Z^{\otimes4},\,Y^{\otimes4}\}\)</span>.<br />
   Because <span class="arithmatex">\(E=E_{03}\otimes E_{21}\)</span> acts on disjoint pairs, 
   <span class="arithmatex">\(E\in S\)</span> if and only if</p>
<div class="arithmatex">\[
     E_{03}\otimes E_{21}\;\in\;\{\,I,I\},\;\{X_0X_3,X_1X_2\},\;\{Z_0Z_3,Z_1Z_2\},\;\{Y_0Y_3,Y_1Y_2\}.
\]</div>
<p>Hence there are exactly four joint events in the numerator:</p>
<div class="arithmatex">\[
     \bigl(P_{03},P_{21}\bigr)
     =
     (I\!,I),\;(X\!X,X\!X),\;(Z\!Z,Z\!Z),\;(Y\!Y,Y\!Y),
\]</div>
<p>each occurring with probability</p>
<div class="arithmatex">\[
     q(P)^2
     =
     \begin{cases}
       (1-p)^2,&amp;P=I\!,\\
       \bigl(\tfrac p{15}\bigr)^2,&amp;P\neq I.
     \end{cases}
\]</div>
<p>Thus</p>
<div class="arithmatex">\[
     N
     =(1-p)^2 \;+\;3\;\Bigl(\frac p{15}\Bigr)^{\!2}
     =1-2p+p^2\;+\;\frac{3p^2}{225}
     =1-2p+\frac{76\,p^2}{75}\,.
\]</div>
<ol start="4">
<li><strong>Computing <span class="arithmatex">\(D\)</span> by parity classes</strong><br />
   A Pauli <span class="arithmatex">\(P\in\mathcal P_4\)</span> commutes with
   <span class="arithmatex">\(S_X\)</span> iff it has an even number of factors in <span class="arithmatex">\(\{Y,Z\}\)</span>,
   and commutes with <span class="arithmatex">\(S_Z\)</span> iff it has an even number of factors in <span class="arithmatex">\(\{X,Y\}\)</span>.
   Restricting to <em>each</em> 2-qubit block <span class="arithmatex">\(\mathcal P_2\)</span>, these two parity conditions split the 16 two-qubit Paulis into four equally-sized “parity classes” of size 4.  Label these classes by <span class="arithmatex">\((r,s)\in\{0,1\}^2\)</span>.  Denote</li>
</ol>
<div class="arithmatex">\[
     p_{r,s}\;=\;\sum_{\substack{P\in\mathcal P_2\\\text{class}(P)=(r,s)}}
                   q(P)\,.
\]</div>
<p>By inspection one finds</p>
<div class="arithmatex">\[
     p_{0,0}=(1-p)+3\,\frac{p}{15}
           =1-\frac{4p}{5},
     \quad
     p_{0,1}=p_{1,0}=p_{1,1}
           =4\,\frac{p}{15}
           =\frac{4p}{15}\,.
\]</div>
<p>Since <span class="arithmatex">\(E_{03},E_{21}\)</span> must lie in <em>the same</em> parity class in order for 
   <span class="arithmatex">\(E_{03}\otimes E_{21}\in N\)</span>, the total undetected probability is</p>
<div class="arithmatex">\[
     D
     =\sum_{(r,s)\in\{0,1\}^2} p_{r,s}^{\,2}
     =\Bigl(1-\tfrac{4p}{5}\Bigr)^2
       +3\;\Bigl(\tfrac{4p}{15}\Bigr)^2
     =1-\frac{8p}{5}+\frac{64\,p^2}{75}\,.
\]</div>
<ol start="5">
<li><strong>Assembling the logical fidelity</strong>  </li>
</ol>
<div class="arithmatex">\[
     F_{\rm logical}
     =\frac{N}{D}
     =\frac{\,1-2p+\tfrac{76\,p^2}{75}\,}
           {\,1-\tfrac{8p}{5}+\tfrac{64\,p^2}{75}\,}
     \;=\;
     \frac{75-150p+76p^2}{75-120p+64p^2}\,.
\]</div>
<p><strong>Final Answer:</strong>  </p>
<div class="arithmatex">\[
\boxed{
F_{\rm logical}(p)
=
\frac{\,1-2p+\tfrac{76}{75}\,p^2\,}
     {\,1-\tfrac{8}{5}\,p+\tfrac{64}{75}\,p^2\,}
\;=\;
\frac{75-150p+76\,p^2}{75-120p+64\,p^2}\,.}
\]</div></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#5</span>
    </div>
    <div class="content markdown-body"><p>Populate your final answer into the code template provided below. This step is purely for formatting/display purposes. No additional reasoning or derivation should be performed. Do not import any modules or packages beyond what is provided in the template.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of the two-qubit gate error rate $p$ in Sympy format.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, the two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, the logical state fidelity as a function of $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># a SymPy expression of inputs</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#6</span>
    </div>
    <div class="content markdown-body"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of the two-qubit gate error rate $p$ in Sympy format.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, the two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, the logical state fidelity as a function of $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="p">(</span><span class="mi">75</span> <span class="o">-</span> <span class="mi">150</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="mi">76</span><span class="o">*</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">75</span> <span class="o">-</span> <span class="mi">120</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="mi">64</span><span class="o">*</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>

</div>

<footer>
  Generated at 2025-09-24T22:02:10.141707
</footer>

<script>
(function() {
  // Tabs
  const tabs = document.querySelectorAll('.tab');
  const panels = document.querySelectorAll('.tab-content');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      panels.forEach(p => p.classList.remove('active'));
      tab.classList.add('active');
      const target = document.querySelector(tab.dataset.target);
      if (target) target.classList.add('active');
    });
  });

  // Theme toggle
  const toggleBtn = document.getElementById('theme-toggle');
  function setTheme(dark) {
    if (dark) {
      document.documentElement.classList.add('dark');
      localStorage.setItem('dark', '1');
    } else {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('dark', '0');
    }
  }
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const stored = localStorage.getItem('dark');
  setTheme(stored === null ? prefersDark : stored === '1');

  toggleBtn.addEventListener('click', () => {
    const isDark = document.documentElement.classList.contains('dark');
    setTheme(!isDark);
  });
})();
</script>
</body>
</html>