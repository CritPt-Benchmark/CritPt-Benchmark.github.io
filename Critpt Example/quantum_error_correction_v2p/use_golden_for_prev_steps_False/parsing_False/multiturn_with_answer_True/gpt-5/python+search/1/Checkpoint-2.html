<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Checkpoint-2</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #3D7B7B; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #F00 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666 } /* Operator */
.codehilite .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #9C6500 } /* Comment.Preproc */
.codehilite .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.codehilite .gr { color: #E40000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #008400 } /* Generic.Inserted */
.codehilite .go { color: #717171 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #04D } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #687822 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #00F; font-weight: bold } /* Name.Class */
.codehilite .no { color: #800 } /* Name.Constant */
.codehilite .nd { color: #A2F } /* Name.Decorator */
.codehilite .ni { color: #717171; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #00F } /* Name.Function */
.codehilite .nl { color: #767600 } /* Name.Label */
.codehilite .nn { color: #00F; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #A2F; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #BBB } /* Text.Whitespace */
.codehilite .mb { color: #666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666 } /* Literal.Number.Float */
.codehilite .mh { color: #666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #A45A77 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #00F } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666 } /* Literal.Number.Integer.Long */

</style>
<style>
    :root {
  --bg: #ffffff;
  --fg: #222222;
  --muted: #555555;
  --border: #e0e0e0;
  --accent: #005fcc;
  --code-bg: #f6f8fa;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
html.dark {
  --bg: #0b0b0b;
  --fg: #e8e8e8;
  --muted: #a0a0a0;
  --border: #333333;
  --accent: #3b82f6;
  --code-bg: #111827;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
* {
  box-sizing: border-box;
}
body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu, "Helvetica Neue", sans-serif;
  line-height: 1.6;
}
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 1.25rem;
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  background: var(--bg);
  z-index: 10;
}
h1 {
  margin: 0;
  font-size: 1.1rem;
}
.tabs {
  display: flex;
  gap: 0.5rem;
}
.tab {
  padding: 0.4rem 0.8rem;
  border: 1px solid var(--border);
  border-bottom: none;
  background: transparent;
  cursor: pointer;
  border-radius: 6px 6px 0 0;
  color: var(--fg);
}
.tab.active {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}
.tab-content {
  display: none;
  padding: 1rem 1.25rem;
  border-top: 1px solid var(--border);
}
.tab-content.active {
  display: block;
}
#theme-toggle {
  border: 1px solid var(--border);
  padding: 0.2rem 0.6rem;
  font-size: 0.9rem;
  border-radius: 4px;
  cursor: pointer;
  background: transparent;
  color: var(--fg);
}
.main {
  max-width: 1200px;
  margin: 0 auto;
}
.message {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.message .meta {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  margin-bottom: 0.6rem;
  color: var(--muted);
  font-size: 0.85rem;
}
.message .badge {
  font-weight: 600;
}
.role-user {
  border-left-color: var(--role-user);
}
.role-assistant {
  border-left-color: var(--role-assistant);
}
.role-system {
  border-left-color: var(--role-system);
}
.role-unknown {
  border-left-color: var(--accent);
}

.output-code-container {
  display: flex;
  gap: 1rem;               /* space between children */
  align-items: center;     /* vertical alignment */
  justify-content: start;  /* horizontal alignment */
}

.output-code-container .codeblock {
  flex: 0 1 auto;
}

.codeblock {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.codeblock-content {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}

.codeblock.eval_code {
  border-left-color: var(--role-user);
}
.codeblock.target_code {
  border-left-color: var(--role-assistant);
}
.codeblock.output_code {
  border-left-color: var(--role-system);
}

html.dark .codeblock-content {
  background: rgba(255,255,255,0.03);
}
.codeblock > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.codeblock > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.codeblock > summary::before {
  content: "▶ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.codeblock[open] > summary::before {
  transform: rotate(90deg);
}
.codeblock .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}

.markdown-body pre code {
  background: var(--code-bg);
  display: block;
  padding: 0.75rem;
  overflow-x: auto;
  border-radius: 4px;
  border: 1px solid var(--border);
}
.markdown-body code {
  background: var(--code-bg);
  padding: 0.15rem 0.3rem;
  border-radius: 4px;
}
/* Extra info tree */
details > summary {
  cursor: pointer;
  font-weight: 600;
}
details .block {
  padding-left: 1rem;
  margin: 0.25rem 0 0.5rem 0;
  border-left: 2px solid var(--border);
}
.kv .key {
  font-weight: 600;
}
.kv .type {
  color: var(--muted);
  margin-left: 0.5rem;
  font-size: 0.85rem;
}
footer {
  margin: 2rem 0;
  text-align: center;
  color: var(--muted);
  font-size: 0.85rem;
}
/* CodeHilite (pygments) overrides to respect theme vars */
.codehilite {
  background: var(--code-bg) !important;
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.75rem !important;
}
.reasoning {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}
html.dark .reasoning {
  background: rgba(255,255,255,0.03);
}
.reasoning > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.reasoning > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.reasoning > summary::before {
  content: "▶ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.reasoning[open] > summary::before {
  transform: rotate(90deg);
}
.reasoning .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}
.reasoning-body {
  margin-top: 0.5rem;
}
</style>

<!-- ===== MATHJAX CONFIG ===== -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ["\\(","\\)"] ],
    displayMath: [ ["\\[","\\]"] ],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    ignoreHtmlClass: ".*",
    processHtmlClass: "arithmatex"

    // skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    // if you dynamically add content later, you can call MathJax.typesetPromise()
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<!-- ========================== -->
</head>
<body>
<header>
  <h1>Checkpoint-2</h1>
  <div>
    <button id="theme-toggle" aria-label="toggle dark mode">🌓</button>
  </div>
</header>

<div class="main">
  
<article class="message role-system">
    <div class="meta">
        <span class="badge">System</span>
        <span class="idx">#0</span>
    </div>
    <div class="content markdown-body"><p>You are a physics research assistant specializing in solving complex, research-level problems using precise, step-by-step reasoning.</p>
<p><strong>Input</strong>
Problems will be provided in Markdown format.</p>
<p><strong>Output (Markdown format)</strong></p>
<ol>
<li><strong>Step-by-Step Derivation</strong> - Show every non-trivial step in the solution.  Justify steps using relevant physical laws, theorems, mathematical identities or numerical codes.</li>
<li><strong>Mathematical Typesetting</strong> - Use LaTeX for all mathematics:  <code>$...$</code> for inline expressions, <code>$$...$$</code> for display equations.</li>
<li><strong>Conventions and Units</strong> - Follow the unit system and conventions specified in the problem.</li>
<li>
<p><strong>Final Answer</strong> - At the end of the solution,  start a new line with <strong>&ldquo;Final Answer:&rdquo;</strong>, and present the final result.</p>
<p>For final answers involving values, follow the precision requirements specified in the problem.
If no precision is specified:
- If an exact value is possible, provide it (e.g., \$\sqrt(2)\$, \$\pi/4\$).
- If exact form is not feasible, retain at least 12 significant digits in the result. </p>
</li>
<li>
<p><strong>Formatting Compliance</strong> - If the user requests a specific output format (e.g., code, table),  provide the final answer accordingly.
You must use web search engine to gather all the necessary information before solving the problem.
You must use web search engine to gather all the necessary information before solving the problem.
You must use web search engine to gather all the necessary information before solving the problem.</p>
</li>
</ol></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#1</span>
    </div>
    <div class="content markdown-body"><h1 id="problem-setup">Problem setup:</h1>
<p>In quantum error correction, you encode quantum states into logical states made of many qubits in order to improve their resilience to errors. In quantum error detection, you do the same but can only detect the presence of errors and not correct them. In this problem, we will consider a single [[4,2,2]] quantum error detection code, which encodes two logical qubits into four physical qubits, and investigate how robust logical quantum operations in this code are to quantum errors.</p>
<p>Our convention is that the four physical qubits in the [[4,2,2]] code are labelled 0,1,2,3. The two logical qubits are labelled A and B. The stabilizers are <span class="arithmatex">\(XXXX\)</span> and <span class="arithmatex">\(ZZZZ\)</span>, where <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> are Pauli matrices. The logical <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> operators on the two qubits are <span class="arithmatex">\(X_A = XIXI\)</span>, <span class="arithmatex">\(X_B=XXII\)</span>, <span class="arithmatex">\(Z_A = ZZII\)</span>, <span class="arithmatex">\(Z_B = ZIZI\)</span>, up to multiplication by stabilizers.</p>
<p>We will consider different state preparation circuits consisting of controlled not <span class="arithmatex">\(CNOT_{ij}\)</span> gates, where <span class="arithmatex">\(CNOT_{ij}\)</span> has control qubit <span class="arithmatex">\(i\)</span> and target qubit <span class="arithmatex">\(j\)</span>. As a simple model of quantum errors in hardware, we will suppose that each <span class="arithmatex">\(CNOT_{ij}\)</span> gate in the circuit has a two qubit depolarizing error channel following it that produces one of the 15 non-identity two-qubit Paulis with equal probability <span class="arithmatex">\(p/15\)</span>. The probability <span class="arithmatex">\(p\)</span> indicates the probability of an error in a single two-qubit gate. We will assess the logical infidelity of certain state preparation protocols as a function of the physical infidelity <span class="arithmatex">\(p\)</span>.</p>
<h1 id="subproblems">Checkpoints</h1>
<h2 id="subproblem-1">Checkpoint 1</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the physical state fidelity of the final physical 4-qubit state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#2</span>
    </div>
    <div class="content markdown-body"><p>1) Step-by-Step Derivation</p>
<ul>
<li>Ideal state prepared by the circuit (no noise)</li>
<li>Start from |0000⟩ on physical qubits 0,1,2,3.</li>
<li>The subcircuit H2 then CNOT21 prepares a Bell state on the pair (2,1): H on the control followed by CNOT maps |00⟩ → |Φ+⟩ = (|00⟩+|11⟩)/√2. Hence qubits (2,1) are in |Φ+⟩21. The subsequent gates act on other qubits, so this entanglement is unaffected. (<a href="https://en.wikipedia.org/wiki/Quantum_logic_gate?utm_source=openai">en.wikipedia.org</a>)</li>
<li>The subcircuit H0 then CNOT03 prepares a Bell state on the pair (0,3), giving |Φ+⟩03. (<a href="https://en.wikipedia.org/wiki/Quantum_logic_gate?utm_source=openai">en.wikipedia.org</a>)</li>
<li>Therefore, the ideal 4-qubit output state is the product of two Bell pairs:</li>
</ul>
<div class="arithmatex">\[
|\psi_{\mathrm{ideal}}\rangle = |\Phi^+\rangle_{21}\otimes|\Phi^+\rangle_{03}.
\]</div>
<ul>
<li>Noise model applied</li>
<li>After each CNOTij, a 2-qubit depolarizing Pauli channel acts on that pair: with probability 1−p do nothing; with probability p choose uniformly one of the 15 non-identity 2-qubit Paulis P∈{IX,IY,IZ, … , ZZ} and apply P (probability p/15 for each). This is the standard “uniform Pauli” description (the 16 two-qubit Paulis are II plus the 15 non-identity strings). (<a href="https://qiskit.github.io/qiskit-aer/stubs/qiskit_aer.noise.depolarizing_error.html">qiskit.github.io</a>, <a href="https://qiskit.qotlabs.org/docs/api/qiskit/2.0/qiskit.quantum_info.PauliList?utm_source=openai">qiskit.qotlabs.org</a>)</li>
<li>In our circuit, the two such channels act on disjoint pairs (2,1) and (0,3), and there are no subsequent gates touching those qubits after each error is applied; thus the final state is</li>
</ul>
<div class="arithmatex">\[
\rho_{\mathrm{out}}=\mathcal{E}_{21}\!\left(|\Phi^+\rangle\!\langle\Phi^+|_{21}\right)\;\otimes\;\mathcal{E}_{03}\!\left(|\Phi^+\rangle\!\langle\Phi^+|_{03}\right),
\]</div>
<div class="codehilite"><pre><span></span><code>i.e., a tensor product of two independently–noisy Bell pairs.
</code></pre></div>

<ul>
<li>Fidelity for a single noisy Bell pair</li>
<li>For a target pure state |ψ⟩, the fidelity with a state ρ is F=⟨ψ|ρ|ψ⟩ (we use the “squared” fidelity convention). For our tensor-product target |ψideal⟩ the total fidelity factorizes as the product of the two pairwise fidelities (see next bullet). (<a href="https://en.wikipedia.org/wiki/Fidelity_of_quantum_states?utm_source=openai">en.wikipedia.org</a>)</li>
<li>Because ρout is a product and |ψideal⟩ is a product, the fidelity factorizes:</li>
</ul>
<div class="arithmatex">\[
\]</div>
<div class="codehilite"><pre><span></span><code>This follows from ⟨a⊗b| (A⊗B) |a⊗b⟩ = ⟨a|A|a⟩ ⟨b|B|b⟩.
</code></pre></div>

<ul>
<li>Evaluate Fpair for one pair subject to the 2-qubit Pauli channel:</li>
</ul>
<div class="arithmatex">\[
F_{\text{pair}}=\sum_{P} \Pr(P)\,|\langle\Phi^+|P|\Phi^+\rangle|^2,
\]</div>
<div class="codehilite"><pre><span></span><code>where P runs over {II}∪{15 non-identity Paulis}.
- The Bell state |Φ+⟩ is a simultaneous eigenstate of X⊗X and Z⊗Z with eigenvalue +1, and of Y⊗Y with eigenvalue −1:
</code></pre></div>

<div class="arithmatex">\[
(X\!\otimes\!X)|\Phi^+\rangle=|\Phi^+\rangle,\quad (Z\!\otimes\!Z)|\Phi^+\rangle=|\Phi^+\rangle,\quad (Y\!\otimes\!Y)|\Phi^+\rangle=-|\Phi^+\rangle.
\]</div>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="n">Hence</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">two</span><span class="o">-</span><span class="n">qubit</span><span class="w"> </span><span class="n">Paulis</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="o">|</span><span class="err">Φ</span><span class="o">+</span><span class="err">⟩</span><span class="w"> </span><span class="n">invariant</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">phase</span><span class="o">.</span><span class="w"> </span><span class="n">All</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">identity</span><span class="w"> </span><span class="n">two</span><span class="o">-</span><span class="n">qubit</span><span class="w"> </span><span class="n">Paulis</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">|</span><span class="err">Φ</span><span class="o">+</span><span class="err">⟩</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="p">(</span><span class="n">orthogonal</span><span class="p">)</span><span class="w"> </span><span class="n">Bell</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w"> </span><span class="n">giving</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">overlap</span><span class="o">.</span><span class="w"> </span><span class="p">([</span><span class="n">chem</span><span class="o">.</span><span class="n">libretexts</span><span class="o">.</span><span class="n">org</span><span class="p">](</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">chem</span><span class="o">.</span><span class="n">libretexts</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">Bookshelves</span><span class="o">/</span><span class="n">Physical_and_Theoretical_Chemistry_Textbook_Maps</span><span class="o">/</span><span class="n">Quantum_Tutorials_</span><span class="o">%</span><span class="mi">28</span><span class="n">Rioux</span><span class="o">%</span><span class="mi">29</span><span class="o">/</span><span class="mi">08</span><span class="o">%</span><span class="mi">3</span><span class="n">A_Quantum_Teleportation</span><span class="o">/</span><span class="mf">8.53</span><span class="o">%</span><span class="mi">3</span><span class="n">A_Bell_State_Exercises</span><span class="err">?</span><span class="n">utm_source</span><span class="o">=</span><span class="n">openai</span><span class="p">))</span>
<span class="o">-</span><span class="w"> </span><span class="n">Therefore</span><span class="p">,</span>
</code></pre></div>

<div class="arithmatex">\[
\]</div>
<ul>
<li>Total physical-state fidelity</li>
<li>Using Fphys = Fpair^2,</li>
</ul>
<div class="arithmatex">\[
F_{\mathrm{phys}}(p)=\Big(1-\frac{4}{5}p\Big)^2.
\]</div>
<p>2) Mathematical Identities Used</p>
<ul>
<li>Bell-state creation by H on the control followed by CNOT: CNOT(H⊗I)|00⟩ = (|00⟩+|11⟩)/√2. (<a href="https://en.wikipedia.org/wiki/Quantum_logic_gate?utm_source=openai">en.wikipedia.org</a>)</li>
<li>The 2-qubit Pauli set has 16 elements (II and the 15 non-identity strings); “uniform Pauli” depolarizing distributes weight equally over those non-identity Paulis. (<a href="https://qiskit.qotlabs.org/docs/api/qiskit/2.0/qiskit.quantum_info.PauliList?utm_source=openai">qiskit.qotlabs.org</a>, <a href="https://qiskit.github.io/qiskit-aer/stubs/qiskit_aer.noise.depolarizing_error.html">qiskit.github.io</a>)</li>
<li>Bell states are eigenstates of X⊗X, Z⊗Z (and Y⊗Y), so XX, YY, ZZ stabilize |Φ+⟩ up to a phase; the four Bell states form an orthonormal basis. (<a href="https://chem.libretexts.org/Bookshelves/Physical_and_Theoretical_Chemistry_Textbook_Maps/Quantum_Tutorials_%28Rioux%29/08%3A_Quantum_Teleportation/8.53%3A_Bell_State_Exercises?utm_source=openai">chem.libretexts.org</a>, <a href="https://en.wikipedia.org/wiki/Bell_state">en.wikipedia.org</a>)</li>
<li>Fidelity with a pure target equals F = ⟨ψ|ρ|ψ⟩. (<a href="https://en.wikipedia.org/wiki/Fidelity_of_quantum_states?utm_source=openai">en.wikipedia.org</a>)</li>
</ul>
<p>3) Conventions and Units</p>
<ul>
<li>Fidelity is taken as F(|ψ⟩,ρ) = ⟨ψ|ρ|ψ⟩ (not the root-fidelity). (<a href="https://en.wikipedia.org/wiki/Fidelity_of_quantum_states?utm_source=openai">en.wikipedia.org</a>)</li>
<li>Error rate p is the probability that a given CNOT is followed by a non-identity 2-qubit Pauli error; each of the 15 non-identity Paulis occurs with probability p/15. This channel acts once per CNOT, on that gate’s two qubits. (<a href="https://qiskit.github.io/qiskit-aer/stubs/qiskit_aer.noise.depolarizing_error.html">qiskit.github.io</a>, <a href="https://qiskit.qotlabs.org/docs/api/qiskit/2.0/qiskit.quantum_info.PauliList?utm_source=openai">qiskit.qotlabs.org</a>)</li>
</ul>
<p>4) Final Answer:
Fphys(p) = (1 − 4p/5)^2.</p></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#3</span>
    </div>
    <div class="content markdown-body"><p>The correct answer is:
$
F_{\rm{physical}}=(1-\frac{12}{15}p)^2
$</p>
<p>Now let&rsquo;s solve the next Checkpoint.</p>
<h2 id="subproblem-2">Checkpoint 2</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the logical state fidelity of the final 2-qubit logical state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>, assuming the state is post-selected on all detectable errors in the code?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#4</span>
    </div>
    <div class="content markdown-body"><p>1) Step-by-Step Derivation</p>
<ul>
<li>Ideal output of the circuit (no noise)</li>
<li>Start from |0000⟩ on qubits (0,1,2,3).</li>
<li>The rightmost subcircuit H2 then CNOT21 prepares a Bell state on qubits (2,1): CNOT(H⊗I)|00⟩ = |Φ+⟩ = (|00⟩+|11⟩)/√2. Hence qubits (2,1) are in |Φ+⟩21. The later gates act only on (0,3). (<a href="https://en.wikipedia.org/wiki/Bell_state?utm_source=openai">en.wikipedia.org</a>)</li>
<li>The subcircuit H0 then CNOT03 similarly prepares |Φ+⟩03 on (0,3). Therefore the ideal 4-qubit output state is</li>
</ul>
<div class="arithmatex">\[
|\psi_{\mathrm{ideal}}\rangle = |\Phi^+\rangle_{21}\otimes|\Phi^+\rangle_{03}.
\]</div>
<ul>
<li>Noise model and its localization</li>
<li>
<p>After each CNOT, a two-qubit depolarizing Pauli channel acts on that gate’s two qubits: with probability 1−p nothing happens, and with probability p one of the 15 non-identity two-qubit Paulis is applied uniformly (probability p/15 each). The two noisy channels act on disjoint pairs (2,1) and (0,3). (<a href="https://qiskit.github.io/qiskit-aer/stubs/qiskit_aer.noise.depolarizing_error.html?utm_source=openai">qiskit.github.io</a>, <a href="https://quantumchannelzoo.org/channel/depolarizing?utm_source=openai">quantumchannelzoo.org</a>)</p>
</li>
<li>
<p>How a two-qubit Pauli acts on a Bell state</p>
</li>
<li>The Bell states are simultaneous eigenstates of X⊗X and Z⊗Z; in particular,</li>
</ul>
<div class="arithmatex">\[
|\Phi^+\rangle \text{ has } (X\!\otimes\!X)=+1,\ (Z\!\otimes\!Z)=+1.
\]</div>
<div class="codehilite"><pre><span></span><code><span class="nv">The</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">two</span><span class="o">-</span><span class="nv">qubit</span><span class="w"> </span><span class="nv">Paulis</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">map</span><span class="w"> </span><span class="o">|</span>Φ<span class="o">+</span>⟩<span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">itself</span><span class="w"> </span><span class="ss">(</span><span class="nv">up</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">phase</span><span class="ss">)</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">XX</span>,<span class="w"> </span><span class="nv">YY</span>,<span class="w"> </span><span class="nv">ZZ</span><span class="c1">; all the other 12 map it to one of the other three Bell states {Φ−, Ψ+, Ψ−}. Consequently, for one noisy pair,</span>
</code></pre></div>

<div class="arithmatex">\[
\Pr(\Phi^+) = 1-\tfrac{12}{15}p,\qquad \Pr(\Phi^-)=\Pr(\Psi^+)=\Pr(\Psi^-)=\tfrac{4}{15}p.
\]</div>
<div class="codehilite"><pre><span></span><code>The two pairs are independent. ([qubit.guide](https://qubit.guide/7.3-single-stabiliser-states?utm_source=openai))
</code></pre></div>

<ul>
<li>Post-selection on the [[4,2,2]] code stabilizers</li>
<li>The code stabilizers are S = ⟨XXXX, ZZZZ⟩. On the product form, XXXX = (X0X3)(X2X1) and ZZZZ = (Z0Z3)(Z2Z1). Measuring XXXX (resp. ZZZZ) on the product of two Bell states returns the product of the XX (resp. ZZ) eigenvalues of the two pairs. We post-select runs with +1 for both stabilizers, which is equivalent to requiring that the two pairs have identical (XX, ZZ) eigenvalue pairs, i.e., they are the same Bell state. (<a href="https://ar5iv.labs.arxiv.org/html/1907.11157v1?utm_source=openai">ar5iv.labs.arxiv.org</a>)</li>
<li>Therefore the acceptance probability is</li>
</ul>
<div class="arithmatex">\[
    =(1-\tfrac{12}{15}p)^2+3\Big(\tfrac{4}{15}p\Big)^2
\]</div>
<ul>
<li>Logical state produced upon acceptance and its fidelity</li>
<li>Conditioning on acceptance, the four-qubit state is stabilized by XXXX, ZZZZ and also by IXXI and IZZI with eigenvalues inherited from the (2,1)-pair. Thus the accepted state is exactly the logical Bell state whose (XX, ZZ) logical stabilizers match the pair’s eigenvalues: if both pairs are Φ+, we get the target logical |Φ+⟩AB; if both are Φ−, Ψ+, or Ψ−, we obtain the corresponding other logical Bell state, orthogonal to the target. Hence the logical-state fidelity equals the conditional probability that both pairs are Φ+:</li>
</ul>
<div class="arithmatex">\[
      =\frac{\Pr(\Phi^+)^2}{P_{\rm acc}(p)}
\]</div>
<div class="codehilite"><pre><span></span><code>Equivalently,
</code></pre></div>

<div class="arithmatex">\[
\]</div>
<div class="codehilite"><pre><span></span><code>showing first-order error suppression under post-selection (distance-2 detection). ([qubit.guide](https://qubit.guide/7.3-single-stabiliser-states?utm_source=openai), [ar5iv.labs.arxiv.org](https://ar5iv.labs.arxiv.org/html/1907.11157v1?utm_source=openai))
</code></pre></div>

<p>2) Mathematical identities and checks used</p>
<ul>
<li>Factorization of stabilizer measurements across the two Bell pairs: XXXX = (X0X3)(X2X1), ZZZZ = (Z0Z3)(Z2Z1). The eigenvalue measured is the product of pairwise eigenvalues. This matches the Bell-state eigenvalue table for XX and ZZ. (<a href="https://qubit.guide/7.3-single-stabiliser-states?utm_source=openai">qubit.guide</a>)</li>
<li>Two-qubit depolarizing channel chooses uniformly among the 15 non-identity two-qubit Pauli operators. (<a href="https://qiskit.github.io/qiskit-aer/stubs/qiskit_aer.noise.depolarizing_error.html?utm_source=openai">qiskit.github.io</a>)</li>
</ul>
<p>3) Conventions and Units</p>
<ul>
<li>Fidelity with a pure target state |ψ⟩ is F = ⟨ψ|ρ|ψ⟩.</li>
<li>Error rate p is the probability that a given CNOT is followed by a non-identity 2-qubit Pauli error (each of the 15 non-identity Paulis occurs with probability p/15). (<a href="https://qiskit.github.io/qiskit-aer/stubs/qiskit_aer.noise.depolarizing_error.html?utm_source=openai">qiskit.github.io</a>)</li>
</ul>
<p>4) Final Answer:</p>
<div class="arithmatex">\[
=\frac{(1-\frac{4}{5}p)^2}{1-\frac{8}{5}p+\frac{64}{75}p^2}
\]</div></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#5</span>
    </div>
    <div class="content markdown-body"><p>Populate your final answer into the code template provided below. This step is purely for formatting/display purposes. No additional reasoning or derivation should be performed. Do not import any modules or packages beyond what is provided in the template.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of the two-qubit gate error rate $p$ in Sympy format.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, the two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, the logical state fidelity as a function of $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># a SymPy expression of inputs</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#6</span>
    </div>
    <div class="content markdown-body"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of the two-qubit gate error rate $p$ in Sympy format.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, the two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, the logical state fidelity as a function of $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>

</div>

<footer>
  Generated at 2025-09-24T22:02:11.581567
</footer>

<script>
(function() {
  // Tabs
  const tabs = document.querySelectorAll('.tab');
  const panels = document.querySelectorAll('.tab-content');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      panels.forEach(p => p.classList.remove('active'));
      tab.classList.add('active');
      const target = document.querySelector(tab.dataset.target);
      if (target) target.classList.add('active');
    });
  });

  // Theme toggle
  const toggleBtn = document.getElementById('theme-toggle');
  function setTheme(dark) {
    if (dark) {
      document.documentElement.classList.add('dark');
      localStorage.setItem('dark', '1');
    } else {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('dark', '0');
    }
  }
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const stored = localStorage.getItem('dark');
  setTheme(stored === null ? prefersDark : stored === '1');

  toggleBtn.addEventListener('click', () => {
    const isDark = document.documentElement.classList.contains('dark');
    setTheme(!isDark);
  });
})();
</script>
</body>
</html>