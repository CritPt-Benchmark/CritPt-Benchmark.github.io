<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Checkpoint-2</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #3D7B7B; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #F00 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666 } /* Operator */
.codehilite .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #9C6500 } /* Comment.Preproc */
.codehilite .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.codehilite .gr { color: #E40000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #008400 } /* Generic.Inserted */
.codehilite .go { color: #717171 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #04D } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #687822 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #00F; font-weight: bold } /* Name.Class */
.codehilite .no { color: #800 } /* Name.Constant */
.codehilite .nd { color: #A2F } /* Name.Decorator */
.codehilite .ni { color: #717171; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #00F } /* Name.Function */
.codehilite .nl { color: #767600 } /* Name.Label */
.codehilite .nn { color: #00F; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #A2F; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #BBB } /* Text.Whitespace */
.codehilite .mb { color: #666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666 } /* Literal.Number.Float */
.codehilite .mh { color: #666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #A45A77 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #00F } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666 } /* Literal.Number.Integer.Long */

</style>
<style>
    :root {
  --bg: #ffffff;
  --fg: #222222;
  --muted: #555555;
  --border: #e0e0e0;
  --accent: #005fcc;
  --code-bg: #f6f8fa;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
html.dark {
  --bg: #0b0b0b;
  --fg: #e8e8e8;
  --muted: #a0a0a0;
  --border: #333333;
  --accent: #3b82f6;
  --code-bg: #111827;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
* {
  box-sizing: border-box;
}
body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu, "Helvetica Neue", sans-serif;
  line-height: 1.6;
}
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 1.25rem;
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  background: var(--bg);
  z-index: 10;
}
h1 {
  margin: 0;
  font-size: 1.1rem;
}
.tabs {
  display: flex;
  gap: 0.5rem;
}
.tab {
  padding: 0.4rem 0.8rem;
  border: 1px solid var(--border);
  border-bottom: none;
  background: transparent;
  cursor: pointer;
  border-radius: 6px 6px 0 0;
  color: var(--fg);
}
.tab.active {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}
.tab-content {
  display: none;
  padding: 1rem 1.25rem;
  border-top: 1px solid var(--border);
}
.tab-content.active {
  display: block;
}
#theme-toggle {
  border: 1px solid var(--border);
  padding: 0.2rem 0.6rem;
  font-size: 0.9rem;
  border-radius: 4px;
  cursor: pointer;
  background: transparent;
  color: var(--fg);
}
.main {
  max-width: 1200px;
  margin: 0 auto;
}
.message {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.message .meta {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  margin-bottom: 0.6rem;
  color: var(--muted);
  font-size: 0.85rem;
}
.message .badge {
  font-weight: 600;
}
.role-user {
  border-left-color: var(--role-user);
}
.role-assistant {
  border-left-color: var(--role-assistant);
}
.role-system {
  border-left-color: var(--role-system);
}
.role-unknown {
  border-left-color: var(--accent);
}

.output-code-container {
  display: flex;
  gap: 1rem;               /* space between children */
  align-items: center;     /* vertical alignment */
  justify-content: start;  /* horizontal alignment */
}

.output-code-container .codeblock {
  flex: 0 1 auto;
}

.codeblock {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.codeblock-content {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}

.codeblock.eval_code {
  border-left-color: var(--role-user);
}
.codeblock.target_code {
  border-left-color: var(--role-assistant);
}
.codeblock.output_code {
  border-left-color: var(--role-system);
}

html.dark .codeblock-content {
  background: rgba(255,255,255,0.03);
}
.codeblock > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.codeblock > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.codeblock > summary::before {
  content: "â–¶ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.codeblock[open] > summary::before {
  transform: rotate(90deg);
}
.codeblock .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}

.markdown-body pre code {
  background: var(--code-bg);
  display: block;
  padding: 0.75rem;
  overflow-x: auto;
  border-radius: 4px;
  border: 1px solid var(--border);
}
.markdown-body code {
  background: var(--code-bg);
  padding: 0.15rem 0.3rem;
  border-radius: 4px;
}
/* Extra info tree */
details > summary {
  cursor: pointer;
  font-weight: 600;
}
details .block {
  padding-left: 1rem;
  margin: 0.25rem 0 0.5rem 0;
  border-left: 2px solid var(--border);
}
.kv .key {
  font-weight: 600;
}
.kv .type {
  color: var(--muted);
  margin-left: 0.5rem;
  font-size: 0.85rem;
}
footer {
  margin: 2rem 0;
  text-align: center;
  color: var(--muted);
  font-size: 0.85rem;
}
/* CodeHilite (pygments) overrides to respect theme vars */
.codehilite {
  background: var(--code-bg) !important;
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.75rem !important;
}
.reasoning {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}
html.dark .reasoning {
  background: rgba(255,255,255,0.03);
}
.reasoning > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.reasoning > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.reasoning > summary::before {
  content: "â–¶ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.reasoning[open] > summary::before {
  transform: rotate(90deg);
}
.reasoning .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}
.reasoning-body {
  margin-top: 0.5rem;
}
</style>

<!-- ===== MATHJAX CONFIG ===== -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ["\\(","\\)"] ],
    displayMath: [ ["\\[","\\]"] ],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    ignoreHtmlClass: ".*",
    processHtmlClass: "arithmatex"

    // skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    // if you dynamically add content later, you can call MathJax.typesetPromise()
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<!-- ========================== -->
</head>
<body>
<header>
  <h1>Checkpoint-2</h1>
  <div>
    <button id="theme-toggle" aria-label="toggle dark mode">ðŸŒ“</button>
  </div>
</header>

<div class="main">
  
<article class="message role-system">
    <div class="meta">
        <span class="badge">System</span>
        <span class="idx">#0</span>
    </div>
    <div class="content markdown-body"><p>You are a physics research assistant specializing in solving complex, research-level problems using precise, step-by-step reasoning.</p>
<p><strong>Input</strong>
Problems will be provided in Markdown format.</p>
<p><strong>Output (Markdown format)</strong></p>
<ol>
<li><strong>Step-by-Step Derivation</strong> - Show every non-trivial step in the solution.  Justify steps using relevant physical laws, theorems, or mathematical identities.</li>
<li><strong>Mathematical Typesetting</strong> - Use LaTeX for all mathematics:  <code>$...$</code> for inline expressions, <code>$$...$$</code> for display equations.</li>
<li><strong>Conventions and Units</strong> - Follow the unit system and conventions specified in the problem.</li>
<li>
<p><strong>Final Answer</strong> - At the end of the solution,  start a new line with <strong>&ldquo;Final Answer:&rdquo;</strong>, and present the final result.</p>
<p>For final answers involving values, follow the precision requirements specified in the problem.
If no precision is specified:
- If an exact value is possible, provide it (e.g., \$\sqrt(2)\$, \$\pi/4\$).
- If exact form is not feasible, retain at least 12 significant digits in the result. </p>
</li>
<li>
<p><strong>Formatting Compliance</strong> - If the user requests a specific output format (e.g., code, table),  provide the final answer accordingly.</p>
</li>
</ol></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#1</span>
    </div>
    <div class="content markdown-body"><h1 id="problem-setup">Problem setup:</h1>
<p>In quantum error correction, you encode quantum states into logical states made of many qubits in order to improve their resilience to errors. In quantum error detection, you do the same but can only detect the presence of errors and not correct them. In this problem, we will consider a single [[4,2,2]] quantum error detection code, which encodes two logical qubits into four physical qubits, and investigate how robust logical quantum operations in this code are to quantum errors.</p>
<p>Our convention is that the four physical qubits in the [[4,2,2]] code are labelled 0,1,2,3. The two logical qubits are labelled A and B. The stabilizers are <span class="arithmatex">\(XXXX\)</span> and <span class="arithmatex">\(ZZZZ\)</span>, where <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> are Pauli matrices. The logical <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> operators on the two qubits are <span class="arithmatex">\(X_A = XIXI\)</span>, <span class="arithmatex">\(X_B=XXII\)</span>, <span class="arithmatex">\(Z_A = ZZII\)</span>, <span class="arithmatex">\(Z_B = ZIZI\)</span>, up to multiplication by stabilizers.</p>
<p>We will consider different state preparation circuits consisting of controlled not <span class="arithmatex">\(CNOT_{ij}\)</span> gates, where <span class="arithmatex">\(CNOT_{ij}\)</span> has control qubit <span class="arithmatex">\(i\)</span> and target qubit <span class="arithmatex">\(j\)</span>. As a simple model of quantum errors in hardware, we will suppose that each <span class="arithmatex">\(CNOT_{ij}\)</span> gate in the circuit has a two qubit depolarizing error channel following it that produces one of the 15 non-identity two-qubit Paulis with equal probability <span class="arithmatex">\(p/15\)</span>. The probability <span class="arithmatex">\(p\)</span> indicates the probability of an error in a single two-qubit gate. We will assess the logical infidelity of certain state preparation protocols as a function of the physical infidelity <span class="arithmatex">\(p\)</span>.</p>
<h1 id="subproblems">Checkpoints</h1>
<h2 id="subproblem-1">Checkpoint 1</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the physical state fidelity of the final physical 4-qubit state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#2</span>
    </div>
    <div class="content markdown-body"><h3 id="1-step-by-step-derivation">1. Step-by-Step Derivation</h3>
<ol>
<li><strong>Ideal circuit action</strong></li>
</ol>
<p>â€¢ Start from the computational vacuum  </p>
<div class="arithmatex">\[
      |0000\rangle_{0123}.
\]</div>
<p>â€¢ Apply the gates in the (right-to-left) order given in the problem</p>
<div class="arithmatex">\[
      (CNOT_{03})\; H_0\; (CNOT_{21})\; H_2 .
\]</div>
<p>â€¢ After the first two operations  </p>
<div class="arithmatex">\[
      H_2 :\; |0000\rangle \;\longrightarrow\;
      \frac{|0\rangle_2+|1\rangle_2}{\sqrt2}\otimes|000\rangle_{013},
\]</div>
<div class="arithmatex">\[
      CNOT_{21} :\;
      \frac{|0\rangle_2|0\rangle_1+|1\rangle_2|1\rangle_1}{\sqrt2}\otimes|00\rangle_{03}
      = |\Phi^{+}\rangle_{21}\otimes|00\rangle_{03},
\]</div>
<p>where  <span class="arithmatex">\( |\Phi^{+}\rangle\equiv (|00\rangle+|11\rangle)/\sqrt2 \)</span>.</p>
<p>â€¢ After the last two operations  </p>
<div class="arithmatex">\[
      H_0:\; |00\rangle_{03}\;\longrightarrow\;
      \frac{|0\rangle_0+|1\rangle_0}{\sqrt2}\otimes|0\rangle_3 ,
\]</div>
<div class="arithmatex">\[
      CNOT_{03}:\;
      \frac{|0\rangle_0|0\rangle_3 + |1\rangle_0|1\rangle_3}{\sqrt2}
      = |\Phi^{+}\rangle_{03}.
\]</div>
<p>â€¢ Hence the <strong>ideal final 4-qubit state</strong></p>
<div class="arithmatex">\[
      |\psi_{\text{ideal}}\rangle
      = |\Phi^{+}\rangle_{21}\;\otimes\;|\Phi^{+}\rangle_{03}.
\]</div>
<p>It is a stabilizer state whose independent generators can be chosen as  </p>
<div class="arithmatex">\[
      \bigl\{\,Z_2Z_1,\;X_2X_1,\;Z_0Z_3,\;X_0X_3\,\bigr\}.
\]</div>
<ol start="2">
<li><strong>Error model</strong></li>
</ol>
<p>â€¢ After each CNOT gate a two-qubit depolarising channel acts on the same two qubits:</p>
<div class="arithmatex">\[
      \mathcal{D}_{ij}^{(p)}(\rho)=
      (1-p)\,\rho+\frac{p}{15}\sum_{P\neq I\otimes I}P_{ij}\,\rho\,P_{ij}.
\]</div>
<p>â€¢ There are two such channels:
     â€“ <span class="arithmatex">\(\mathcal{D}_{21}^{(p)}\)</span> immediately after <span class="arithmatex">\(CNOT_{21}\)</span><br />
     â€“ <span class="arithmatex">\(\mathcal{D}_{03}^{(p)}\)</span> immediately after <span class="arithmatex">\(CNOT_{03}\)</span>.</p>
<p>â€¢ Denote the Pauli error applied by the first channel by <span class="arithmatex">\(E_{21}\)</span><br />
     (acting only on qubits 2 and 1) and the second by <span class="arithmatex">\(E_{03}\)</span><br />
     (acting only on qubits 0 and 3).</p>
<p>â€¢ Because the gates following <span class="arithmatex">\(E_{21}\)</span> touch only qubits 0 and 3, the two
     error operators act on <strong>disjoint pairs</strong> and therefore commute.
     The final physical state is</p>
<div class="arithmatex">\[
        \rho(p)=
        \sum_{E_{21},E_{03}} 
        p(E_{21})\,p(E_{03})\;
        E_{03}\,E_{21}\;
        |\psi_{\text{ideal}}\rangle\langle\psi_{\text{ideal}}|\;
        E_{21}\,E_{03},
\]</div>
<div class="codehilite"><pre><span></span><code> where
</code></pre></div>

<div class="arithmatex">\[
       p(E)=
       \begin{cases}
          1-p, &amp; E=I\otimes I,\\[4pt]
          p/15,&amp; \text{any of the 15 non-identity Paulis.}
       \end{cases}
\]</div>
<ol start="3">
<li><strong>When does a Pauli error leave the state invariant?</strong></li>
</ol>
<p>â€¢ For any stabilizer state <span class="arithmatex">\(|\psi\rangle\)</span>, a Pauli operator <span class="arithmatex">\(P\)</span> satisfies<br />
<span class="arithmatex">\(\langle\psi|P|\psi\rangle=\pm1\)</span> if <span class="arithmatex">\(P\)</span> is in the stabilizer group
     and <span class="arithmatex">\(0\)</span> otherwise, hence  </p>
<div class="arithmatex">\[
        F=\langle\psi_{\text{ideal}}|\rho(p)|\psi_{\text{ideal}}\rangle
        =\sum_{E_{21},E_{03}}
        p(E_{21})\,p(E_{03})
        \,\delta\bigl(E_{21}E_{03}\in\mathcal{S}\bigr).
\]</div>
<p>â€¢ Because the stabilizer factors into the two Bell-pair stabilizers,
     <span class="arithmatex">\(E_{21}E_{03}\in\mathcal{S}\)</span>
     â‡” <span class="arithmatex">\(E_{21}\in\{I,X_2X_1,Z_2Z_1,Y_2Y_1\}\)</span> <strong>and</strong>
        <span class="arithmatex">\(E_{03}\in\{I,X_0X_3,Z_0Z_3,Y_0Y_3\}\)</span>.</p>
<p>â€¢ For one depolarising channel</p>
<div class="arithmatex">\[
        P_{\text{pair}}(E\in\text{local stabilizer})
        =(1-p)+\frac{3p}{15}=1-\frac{4p}{5}.
\]</div>
<ol start="4">
<li><strong>Physical state fidelity</strong></li>
</ol>
<p>â€¢ The two error channels are independent, so the total fidelity is the
     product of the two probabilities:</p>
<div class="arithmatex">\[
       F(p)=\Bigl(1-\frac{4p}{5}\Bigr)^2.
\]</div>
<h3 id="2-mathematical-typesetting">2. Mathematical Typesetting</h3>
<p>All equations above are typeset in LaTeX.</p>
<h3 id="3-conventions-and-units">3. Conventions and Units</h3>
<p>The error rate <span class="arithmatex">\(p\)</span> is dimensionless.  Fidelity is dimensionless and lies in
[0\le F\le1.]</p>
<h3 id="4-final-answer">4. Final Answer</h3>
<p>Final Answer:  </p>
<div class="arithmatex">\[
\boxed{\,F(p)=\Bigl(1-\dfrac{4p}{5}\Bigr)^2\,}
\]</div></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#3</span>
    </div>
    <div class="content markdown-body"><p>The correct answer is:
$
F_{\rm{physical}}=(1-\frac{12}{15}p)^2
$</p>
<p>Now let&rsquo;s solve the next Checkpoint.</p>
<h2 id="subproblem-2">Checkpoint 2</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the logical state fidelity of the final 2-qubit logical state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>, assuming the state is post-selected on all detectable errors in the code?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#4</span>
    </div>
    <div class="content markdown-body"><h3 id="1-stepbystep-derivation">1. Stepâ€“byâ€“Step Derivation</h3>
<ol>
<li><strong>Ideal encoded state</strong></li>
</ol>
<p>Exactly as in the previous checkpoint, in the absence of faults the circuit  </p>
<div class="arithmatex">\[
     (CNOT_{03})\;H_0\;(CNOT_{21})\;H_2
\]</div>
<p>prepares the fourâ€“qubit state  </p>
<div class="arithmatex">\[
     |\psi_{\rm id}\rangle
        =|\Phi^{+}\rangle_{21}\otimes|\Phi^{+}\rangle_{03},\qquad  
     |\Phi^{+}\rangle\equiv\frac{|00\rangle+|11\rangle}{\sqrt2},
\]</div>
<p>which is the logical Bell state  </p>
<div class="arithmatex">\[
     |\Psi^{+}\rangle_{AB}
        =\frac{|00\rangle_{AB}+|11\rangle_{AB}}{\sqrt2}.
\]</div>
<p>The <strong>code stabilisers</strong> are  </p>
<div class="arithmatex">\[
      S_X= X_0X_1X_2X_3,\qquad
      S_Z= Z_0Z_1Z_2Z_3 .
\]</div>
<p>The logical Pauliâ€™s (up to stabilisers) are  </p>
<div class="arithmatex">\[
     X_A=X_0X_2,\;X_B=X_0X_1,\quad  
     Z_A=Z_0Z_1,\;Z_B=Z_0Z_2 .
\]</div>
<p>Hence  </p>
<div class="arithmatex">\[
     |\Psi^{+}\rangle_{AB}
         \text{ is stabilised by }
         \{\,S_X,\;S_Z,\;X_AX_B,\;Z_AZ_B\,\}.
\]</div>
<ol start="2">
<li><strong>Noise on the two CNOT gates</strong></li>
</ol>
<p>Each CNOT is followed by an <strong>independent two-qubit depolariser</strong> on the same
   qubits:</p>
<div class="arithmatex">\[
     \mathcal D^{(p)}(\rho)
        =(1-p)\rho+\frac{p}{15}\!\!\sum_{P\neq I\!\otimes\! I}\!
        P\rho P,\qquad P\in\mathcal P_2 .
\]</div>
<p>â€¢  After the first CNOT (<span class="arithmatex">\(21\)</span>) an error <span class="arithmatex">\(E_{21}\)</span> acts on qubits 2 and 1.<br />
   â€¢  After the second CNOT (<span class="arithmatex">\(03\)</span>) an error <span class="arithmatex">\(E_{03}\)</span> acts on qubits 0 and 3.  </p>
<p>The final physical state before syndrome measurement is  </p>
<div class="arithmatex">\[
     \rho(p)=
     \sum_{E_{21},E_{03}} 
          p(E_{21})\,p(E_{03})\;
          E_{03}E_{21}\,
          |\psi_{\rm id}\rangle\langle\psi_{\rm id}|\,
          E_{21}E_{03}.
\]</div>
<ol start="3">
<li><strong>Classifying the two-qubit Paulis</strong></li>
</ol>
<p>For a single qubit Pauli <span class="arithmatex">\(P\)</span> set  </p>
<div class="arithmatex">\[
     c_X(P)=
        \begin{cases}
           1 &amp; P\in\{Z,Y\}\\
           0 &amp; P\in\{I,X\}
        \end{cases},\qquad
     c_Z(P)=
        \begin{cases}
           1 &amp; P\in\{X,Y\}\\
           0 &amp; P\in\{I,Z\}.
        \end{cases}
\]</div>
<p><span class="arithmatex">\(c_X(P)\,[c_Z(P)]\)</span> tells whether <span class="arithmatex">\(P\)</span> anticommutes with the all-<span class="arithmatex">\(X\)</span>
   <span class="arithmatex">\([\,\)</span>all-<span class="arithmatex">\(Z]\)</span> stabiliser.
   For a two-qubit operator <span class="arithmatex">\(P\otimes Q\)</span> define the <strong>parity vector</strong></p>
<div class="arithmatex">\[
      \mathbf b(P\!\otimes\!Q)=
        \bigl(c_X(P)\oplus c_X(Q),\;
              c_Z(P)\oplus c_Z(Q)\bigr)
        \in\{(0,0),(0,1),(1,0),(1,1)\}.
\]</div>
<p>Enumerating the 16 two-qubit Paulis on any fixed pair gives  </p>
<p>â€¢ category <span class="arithmatex">\(\mathcal C_0\;(0,0)\)</span> :  <span class="arithmatex">\(\{II,\,XX,\,YY,\,ZZ\}\)</span><br />
   â€¢ category <span class="arithmatex">\(\mathcal C_1\;(0,1)\)</span> :  <span class="arithmatex">\(\{XI,I X,\,YZ,\,ZY\}\)</span><br />
   â€¢ category <span class="arithmatex">\(\mathcal C_2\;(1,0)\)</span> :  <span class="arithmatex">\(\{ZI,I Z,\,YX,\,XY\}\)</span><br />
   â€¢ category <span class="arithmatex">\(\mathcal C_3\;(1,1)\)</span> :  <span class="arithmatex">\(\{YI,I Y,\,XZ,\,ZX\}\)</span>  </p>
<p>with probabilities</p>
<div class="arithmatex">\[
     p_0 = 1-\frac{4p}{5},\qquad
     p_1=p_2=p_3=\frac{4p}{15}.
\]</div>
<ol start="4">
<li><strong>Syndrome measurement and </strong>post-selection****  </li>
</ol>
<p>Measuring <span class="arithmatex">\(S_X,S_Z\)</span> and accepting only the <span class="arithmatex">\(+1,+1\)</span> outcome projects
   onto the codespace.<br />
   The outcome is trivial <strong>iff the parity vectors of the two pairs coincide</strong>,
   i.e. both errors belong to the <em>same</em> category <span class="arithmatex">\(\mathcal C_k\)</span>.
   Hence the <strong>success probability</strong></p>
<div class="arithmatex">\[
     P_{\rm succ}(p)=p_0^{\,2}+p_1^{\,2}+p_2^{\,2}+p_3^{\,2}
                    =(1-\tfrac{4}{5}p)^2+3\Bigl(\tfrac{4}{15}p\Bigr)^{\!2}
                    =(1-\tfrac{4}{5}p)^2+\tfrac{16}{75}p^{2}.
\]</div>
<ol start="5">
<li><strong>Logical action of the undetected errors</strong></li>
</ol>
<p>â€¢  If both pairs are in <span class="arithmatex">\(\mathcal C_0\)</span> the combined operator is one of  </p>
<div class="arithmatex">\[
        \{\,I,\;S_X,\;S_Z,\;S_XS_Z,\;
          X_AX_B,\;Z_AZ_B,\;Y_AY_B,\;
          {\rm (those\;multiplied\;by\;}S_X\!,S_Z)\},
\]</div>
<div class="codehilite"><pre><span></span><code>  i.e. an element of the 16-element stabiliser of
  \(|\Psi^{+}\rangle_{AB}\).  
  **It leaves the logical state unchanged.**
</code></pre></div>

<p>â€¢  If the shared category is <span class="arithmatex">\(\mathcal C_1,\mathcal C_2\)</span> or <span class="arithmatex">\(\mathcal
      C_3\)</span> the resulting operator is respectively a logical<br />
<span class="arithmatex">\(X_{A/B},\,Z_{A/B}\)</span> or <span class="arithmatex">\(Y_{A/B}\)</span> (up to <span class="arithmatex">\(S_X,S_Z\)</span>),
      all of which map <span class="arithmatex">\(|\Psi^{+}\rangle_{AB}\)</span> to an <em>orthogonal</em> Bell
      state.  The logical fidelity is then zero.</p>
<p>Therefore  </p>
<div class="arithmatex">\[
     F_{\rm logical}(p)
        =\Pr[\,\text{category } \mathcal C_0\mid\text{succ}\,]
        =\frac{p_0^{\,2}}
              {p_0^{\,2}+3p_1^{\,2}}
        =\frac{\bigl(1-\frac{4}{5}p\bigr)^{2}}
              {\bigl(1-\frac{4}{5}p\bigr)^{2}+\frac{16}{75}p^{2}} .
\]</div>
<ol start="6">
<li><strong>Small-<span class="arithmatex">\(p\)</span> expansion</strong></li>
</ol>
<div class="arithmatex">\[
     F_{\rm logical}(p)=1-\frac{16}{75}p^{2}+O(p^{3}),
\]</div>
<p>i.e. all undetected faults are <strong>second-order</strong> in the physical error
   probability, as expected for a distance-2 detection code.</p>
<h3 id="2-mathematical-typesetting">2. Mathematical Typesetting</h3>
<p>All equations have been given in LaTeX.</p>
<h3 id="3-conventions-and-units">3. Conventions and Units</h3>
<p>The gate error rate <span class="arithmatex">\(p\)</span> is dimensionless, as is the fidelity.</p>
<h3 id="4-final-answer">4. Final Answer</h3>
<p>Final Answer:  </p>
<div class="arithmatex">\[
\boxed{\,F_{\text{logical}}(p)=
        \dfrac{\left(1-\dfrac{4}{5}p\right)^{2}}
              {\left(1-\dfrac{4}{5}p\right)^{2}
               +\dfrac{16}{75}\,p^{2}} }\,
\approx 1-\dfrac{16}{75}p^{2}+O(p^{3}).
\]</div></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#5</span>
    </div>
    <div class="content markdown-body"><p>Populate your final answer into the code template provided below. This step is purely for formatting/display purposes. No additional reasoning or derivation should be performed. Do not import any modules or packages beyond what is provided in the template.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of the two-qubit gate error rate $p$ in Sympy format.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, the two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, the logical state fidelity as a function of $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># a SymPy expression of inputs</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#6</span>
    </div>
    <div class="content markdown-body"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of the two-qubit gate error rate $p$ in Sympy format.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, the two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, the logical state fidelity as a function of $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="p">)</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>

</div>

<footer>
  Generated at 2025-09-24T22:02:10.146768
</footer>

<script>
(function() {
  // Tabs
  const tabs = document.querySelectorAll('.tab');
  const panels = document.querySelectorAll('.tab-content');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      panels.forEach(p => p.classList.remove('active'));
      tab.classList.add('active');
      const target = document.querySelector(tab.dataset.target);
      if (target) target.classList.add('active');
    });
  });

  // Theme toggle
  const toggleBtn = document.getElementById('theme-toggle');
  function setTheme(dark) {
    if (dark) {
      document.documentElement.classList.add('dark');
      localStorage.setItem('dark', '1');
    } else {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('dark', '0');
    }
  }
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const stored = localStorage.getItem('dark');
  setTheme(stored === null ? prefersDark : stored === '1');

  toggleBtn.addEventListener('click', () => {
    const isDark = document.documentElement.classList.contains('dark');
    setTheme(!isDark);
  });
})();
</script>
</body>
</html>