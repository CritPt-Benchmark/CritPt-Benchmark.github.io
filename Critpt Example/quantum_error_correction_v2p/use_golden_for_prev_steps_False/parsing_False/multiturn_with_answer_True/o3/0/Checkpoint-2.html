<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Checkpoint-2</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #3D7B7B; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #F00 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666 } /* Operator */
.codehilite .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #9C6500 } /* Comment.Preproc */
.codehilite .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.codehilite .gr { color: #E40000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #008400 } /* Generic.Inserted */
.codehilite .go { color: #717171 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #04D } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #687822 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #00F; font-weight: bold } /* Name.Class */
.codehilite .no { color: #800 } /* Name.Constant */
.codehilite .nd { color: #A2F } /* Name.Decorator */
.codehilite .ni { color: #717171; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #00F } /* Name.Function */
.codehilite .nl { color: #767600 } /* Name.Label */
.codehilite .nn { color: #00F; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #A2F; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #BBB } /* Text.Whitespace */
.codehilite .mb { color: #666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666 } /* Literal.Number.Float */
.codehilite .mh { color: #666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #A45A77 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #00F } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666 } /* Literal.Number.Integer.Long */

</style>
<style>
    :root {
  --bg: #ffffff;
  --fg: #222222;
  --muted: #555555;
  --border: #e0e0e0;
  --accent: #005fcc;
  --code-bg: #f6f8fa;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
html.dark {
  --bg: #0b0b0b;
  --fg: #e8e8e8;
  --muted: #a0a0a0;
  --border: #333333;
  --accent: #3b82f6;
  --code-bg: #111827;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
* {
  box-sizing: border-box;
}
body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu, "Helvetica Neue", sans-serif;
  line-height: 1.6;
}
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 1.25rem;
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  background: var(--bg);
  z-index: 10;
}
h1 {
  margin: 0;
  font-size: 1.1rem;
}
.tabs {
  display: flex;
  gap: 0.5rem;
}
.tab {
  padding: 0.4rem 0.8rem;
  border: 1px solid var(--border);
  border-bottom: none;
  background: transparent;
  cursor: pointer;
  border-radius: 6px 6px 0 0;
  color: var(--fg);
}
.tab.active {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}
.tab-content {
  display: none;
  padding: 1rem 1.25rem;
  border-top: 1px solid var(--border);
}
.tab-content.active {
  display: block;
}
#theme-toggle {
  border: 1px solid var(--border);
  padding: 0.2rem 0.6rem;
  font-size: 0.9rem;
  border-radius: 4px;
  cursor: pointer;
  background: transparent;
  color: var(--fg);
}
.main {
  max-width: 1200px;
  margin: 0 auto;
}
.message {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.message .meta {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  margin-bottom: 0.6rem;
  color: var(--muted);
  font-size: 0.85rem;
}
.message .badge {
  font-weight: 600;
}
.role-user {
  border-left-color: var(--role-user);
}
.role-assistant {
  border-left-color: var(--role-assistant);
}
.role-system {
  border-left-color: var(--role-system);
}
.role-unknown {
  border-left-color: var(--accent);
}

.output-code-container {
  display: flex;
  gap: 1rem;               /* space between children */
  align-items: center;     /* vertical alignment */
  justify-content: start;  /* horizontal alignment */
}

.output-code-container .codeblock {
  flex: 0 1 auto;
}

.codeblock {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.codeblock-content {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}

.codeblock.eval_code {
  border-left-color: var(--role-user);
}
.codeblock.target_code {
  border-left-color: var(--role-assistant);
}
.codeblock.output_code {
  border-left-color: var(--role-system);
}

html.dark .codeblock-content {
  background: rgba(255,255,255,0.03);
}
.codeblock > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.codeblock > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.codeblock > summary::before {
  content: "â–¶ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.codeblock[open] > summary::before {
  transform: rotate(90deg);
}
.codeblock .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}

.markdown-body pre code {
  background: var(--code-bg);
  display: block;
  padding: 0.75rem;
  overflow-x: auto;
  border-radius: 4px;
  border: 1px solid var(--border);
}
.markdown-body code {
  background: var(--code-bg);
  padding: 0.15rem 0.3rem;
  border-radius: 4px;
}
/* Extra info tree */
details > summary {
  cursor: pointer;
  font-weight: 600;
}
details .block {
  padding-left: 1rem;
  margin: 0.25rem 0 0.5rem 0;
  border-left: 2px solid var(--border);
}
.kv .key {
  font-weight: 600;
}
.kv .type {
  color: var(--muted);
  margin-left: 0.5rem;
  font-size: 0.85rem;
}
footer {
  margin: 2rem 0;
  text-align: center;
  color: var(--muted);
  font-size: 0.85rem;
}
/* CodeHilite (pygments) overrides to respect theme vars */
.codehilite {
  background: var(--code-bg) !important;
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.75rem !important;
}
.reasoning {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}
html.dark .reasoning {
  background: rgba(255,255,255,0.03);
}
.reasoning > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.reasoning > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.reasoning > summary::before {
  content: "â–¶ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.reasoning[open] > summary::before {
  transform: rotate(90deg);
}
.reasoning .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}
.reasoning-body {
  margin-top: 0.5rem;
}
</style>

<!-- ===== MATHJAX CONFIG ===== -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ["\\(","\\)"] ],
    displayMath: [ ["\\[","\\]"] ],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    ignoreHtmlClass: ".*",
    processHtmlClass: "arithmatex"

    // skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    // if you dynamically add content later, you can call MathJax.typesetPromise()
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<!-- ========================== -->
</head>
<body>
<header>
  <h1>Checkpoint-2</h1>
  <div>
    <button id="theme-toggle" aria-label="toggle dark mode">ðŸŒ“</button>
  </div>
</header>

<div class="main">
  
<article class="message role-system">
    <div class="meta">
        <span class="badge">System</span>
        <span class="idx">#0</span>
    </div>
    <div class="content markdown-body"><p>You are a physics research assistant specializing in solving complex, research-level problems using precise, step-by-step reasoning.</p>
<p><strong>Input</strong>
Problems will be provided in Markdown format.</p>
<p><strong>Output (Markdown format)</strong></p>
<ol>
<li><strong>Step-by-Step Derivation</strong> - Show every non-trivial step in the solution.  Justify steps using relevant physical laws, theorems, or mathematical identities.</li>
<li><strong>Mathematical Typesetting</strong> - Use LaTeX for all mathematics:  <code>$...$</code> for inline expressions, <code>$$...$$</code> for display equations.</li>
<li><strong>Conventions and Units</strong> - Follow the unit system and conventions specified in the problem.</li>
<li>
<p><strong>Final Answer</strong> - At the end of the solution,  start a new line with <strong>&ldquo;Final Answer:&rdquo;</strong>, and present the final result.</p>
<p>For final answers involving values, follow the precision requirements specified in the problem.
If no precision is specified:
- If an exact value is possible, provide it (e.g., \$\sqrt(2)\$, \$\pi/4\$).
- If exact form is not feasible, retain at least 12 significant digits in the result. </p>
</li>
<li>
<p><strong>Formatting Compliance</strong> - If the user requests a specific output format (e.g., code, table),  provide the final answer accordingly.</p>
</li>
</ol></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#1</span>
    </div>
    <div class="content markdown-body"><h1 id="problem-setup">Problem setup:</h1>
<p>In quantum error correction, you encode quantum states into logical states made of many qubits in order to improve their resilience to errors. In quantum error detection, you do the same but can only detect the presence of errors and not correct them. In this problem, we will consider a single [[4,2,2]] quantum error detection code, which encodes two logical qubits into four physical qubits, and investigate how robust logical quantum operations in this code are to quantum errors.</p>
<p>Our convention is that the four physical qubits in the [[4,2,2]] code are labelled 0,1,2,3. The two logical qubits are labelled A and B. The stabilizers are <span class="arithmatex">\(XXXX\)</span> and <span class="arithmatex">\(ZZZZ\)</span>, where <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> are Pauli matrices. The logical <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> operators on the two qubits are <span class="arithmatex">\(X_A = XIXI\)</span>, <span class="arithmatex">\(X_B=XXII\)</span>, <span class="arithmatex">\(Z_A = ZZII\)</span>, <span class="arithmatex">\(Z_B = ZIZI\)</span>, up to multiplication by stabilizers.</p>
<p>We will consider different state preparation circuits consisting of controlled not <span class="arithmatex">\(CNOT_{ij}\)</span> gates, where <span class="arithmatex">\(CNOT_{ij}\)</span> has control qubit <span class="arithmatex">\(i\)</span> and target qubit <span class="arithmatex">\(j\)</span>. As a simple model of quantum errors in hardware, we will suppose that each <span class="arithmatex">\(CNOT_{ij}\)</span> gate in the circuit has a two qubit depolarizing error channel following it that produces one of the 15 non-identity two-qubit Paulis with equal probability <span class="arithmatex">\(p/15\)</span>. The probability <span class="arithmatex">\(p\)</span> indicates the probability of an error in a single two-qubit gate. We will assess the logical infidelity of certain state preparation protocols as a function of the physical infidelity <span class="arithmatex">\(p\)</span>.</p>
<h1 id="subproblems">Checkpoints</h1>
<h2 id="subproblem-1">Checkpoint 1</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the physical state fidelity of the final physical 4-qubit state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#2</span>
    </div>
    <div class="content markdown-body"><p>Step-by-Step Derivation  </p>
<ol>
<li>Ideal (errorâ€“free) preparation<br />
   â€¢ The circuit  </li>
</ol>
<div class="arithmatex">\[
\bigl(CNOT_{03}\bigr)\, H_{0}\, \bigl(CNOT_{21}\bigr)\, H_{2}
\]</div>
<div class="codehilite"><pre><span></span><code> acting on the initial product state $|0000\rangle_{0123}$ produces
</code></pre></div>

<div class="arithmatex">\[
\]</div>
<div class="codehilite"><pre><span></span><code> (Qubit ordering is $0,1,2,3$.)  
 The encoded state $|\psi_{\text{ideal}}\rangle$ lies in the
 $+1$â€“eigenspace of the stabilizers $XXXX$ and $ZZZZ$ and represents the logical
 two-qubit GHZ state  
 $(|00\rangle_{AB}+|11\rangle_{AB})/\sqrt2$.
</code></pre></div>

<ol start="2">
<li>Error model for a single twoâ€“qubit gate<br />
   â€¢ After every <span class="arithmatex">\(CNOT_{ij}\)</span> we apply an independent two-qubit depolarising
     channel on the same pair <span class="arithmatex">\((i,j)\)</span>:  </li>
</ol>
<div class="arithmatex">\[
       (1-p)\,\rho+\frac{p}{15}\sum_{P\in\mathcal P_{ij}\setminus\{II\}}\!
\]</div>
<div class="codehilite"><pre><span></span><code> where $\mathcal P_{ij}$ is the $4\times4$ two-qubit Pauli group on
 qubits $i$ and $j$.
</code></pre></div>

<p>â€¢ Only the <span class="arithmatex">\(CNOT_{21}\)</span> and <span class="arithmatex">\(CNOT_{03}\)</span> gates are noisy, so two such
     channels act in the whole circuit.</p>
<ol start="3">
<li>Fidelity after one noisy two-qubit gate<br />
   Let <span class="arithmatex">\(\rho=|\psi\rangle\langle\psi|\)</span> be the input to the channel and
   <span class="arithmatex">\(|\psi\rangle\)</span> any pure state.  The output state is
   <span class="arithmatex">\(\rho'=\mathcal D_{ij}(\rho)\)</span>, and its fidelity with <span class="arithmatex">\(\rho\)</span> is  </li>
</ol>
<div class="arithmatex">\[
            =(1-p)+\frac{p}{15}\sum_{P\neq II}
\]</div>
<p>For the particular state <span class="arithmatex">\(|\psi_{\text{ideal}}\rangle\)</span> we must evaluate
   the overlaps <span class="arithmatex">\(\langle\psi_{\text{ideal}}|P|\psi_{\text{ideal}}\rangle\)</span>
   for the 15 non-identity Paulis acting on the relevant two qubits.</p>
<p>â€¢ Qubits 2 &amp; 1 (after <span class="arithmatex">\(CNOT_{21}\)</span>)<br />
     Among the 15 Paulis on qubits 2 and 1
     only the three operators  </p>
<div class="arithmatex">\[
XX_{21},\;YY_{21},\;ZZ_{21}
\]</div>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="o">$|</span>\<span class="n">psi_</span><span class="p">{</span>\<span class="n">text</span><span class="p">{</span><span class="n">ideal</span><span class="p">}}</span>\<span class="n">rangle</span><span class="o">$</span><span class="w"> </span><span class="n">invariant</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">phase</span>
<span class="w"> </span><span class="p">(</span><span class="n">all</span><span class="w"> </span><span class="n">others</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">orthogonal</span><span class="w"> </span><span class="n">subspace</span><span class="p">)</span><span class="o">.</span>
<span class="w"> </span><span class="n">Hence</span>
</code></pre></div>

<div class="arithmatex">\[
\]</div>
<p>â€¢ Qubits 0 &amp; 3 (after <span class="arithmatex">\(CNOT_{03}\)</span>)<br />
     Exactly the same situation holds; the only invariants are  </p>
<div class="arithmatex">\[
XX_{03},\;YY_{03},\;ZZ_{03},
\]</div>
<div class="codehilite"><pre><span></span><code> so the sum of squared overlaps is again 3.
</code></pre></div>

<p>Therefore, for either noisy <span class="arithmatex">\(CNOT\)</span> gate,</p>
<div class="arithmatex">\[
       =(1-p)+\frac{p}{15}\times 3
\]</div>
<ol start="4">
<li>Two independent noisy <span class="arithmatex">\(CNOT\)</span> gates<br />
   The two noise channels act on disjoint pairs of qubits and are
   statistically independent.<br />
   Writing <span class="arithmatex">\(r\equiv 1-\dfrac{4p}{5}\)</span> for the fidelity retention factor of
   one gate, the overall process is</li>
</ol>
<div class="arithmatex">\[
\]</div>
<p>The final fidelity with the ideal state is then</p>
<div class="arithmatex">\[
       =\operatorname{Tr}\!\bigl(|\psi_{\text{ideal}}\rangle\langle\psi_{\text{ideal}}|
                               \,\rho_{\text{final}}\bigr)
       =r^{2}
\]</div>
<p>Expanding,</p>
<div class="arithmatex">\[
F_{\text{phys}}(p)=1-\frac{8p}{5}+\frac{16p^{2}}{25}.
\]</div>
<p>Conventions and units:  All quantities are dimensionless probabilities.
No numerical approximation was required.</p>
<p>Final Answer:<br />
The physical four-qubit state fidelity after the complete preparation
circuit is  </p>
<div class="arithmatex">\[
\]</div></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#3</span>
    </div>
    <div class="content markdown-body"><p>The correct answer is:
$
F_{\rm{physical}}=(1-\frac{12}{15}p)^2
$</p>
<p>Now let&rsquo;s solve the next Checkpoint.</p>
<h2 id="subproblem-2">Checkpoint 2</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the logical state fidelity of the final 2-qubit logical state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>, assuming the state is post-selected on all detectable errors in the code?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#4</span>
    </div>
    <div class="content markdown-body"><p>Step-by-Step Derivation  </p>
<ol>
<li>Error filtering by the code<br />
    â€¢  After each <span class="arithmatex">\(CNOT\)</span> a twoâ€“qubit depolarising channel acts on the same
       two physical qubits.<br />
    â€¢  We subsequently measure the two stabilisers  </li>
</ol>
<div class="arithmatex">\[
S_1=XXXX,\qquad S_2=ZZZZ
\]</div>
<div class="codehilite"><pre><span></span><code><span class="w">   </span><span class="ow">and</span><span class="w"> </span><span class="nv">keep</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">run</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="p">$</span><span class="o">+</span><span class="mi">1</span><span class="p">$</span><span class="w"> </span><span class="nv">syndrome</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nf">obtained</span><span class="w"> </span><span class="p">(</span>â€œ<span class="nv">post</span><span class="o">-</span>
<span class="w">   </span><span class="nv">selection</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">detectable</span><span class="w"> </span><span class="nv">errors</span>â€™â€™<span class="p">)</span><span class="o">.</span>

â€¢<span class="w">  </span><span class="nv">For</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">two</span>â€“<span class="nv">qubit</span><span class="w"> </span><span class="nv">depolarising</span><span class="w"> </span><span class="nv">channel</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">probabilities</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">single</span>
<span class="w">   </span><span class="nv">gate</span><span class="w"> </span><span class="nv">are</span><span class="w">  </span>
<span class="w">   </span>â€“<span class="w"> </span><span class="nf">identity</span><span class="w"> </span><span class="p">(</span><span class="nv">no</span><span class="w"> </span><span class="nv">error</span><span class="p">)</span><span class="w">                </span><span class="p">$</span><span class="mi">1</span><span class="o">-</span><span class="nv">p</span><span class="p">$</span><span class="w">  </span>
<span class="w">   </span>â€“<span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="nv">non</span><span class="o">-</span><span class="nv">identity</span><span class="w"> </span><span class="nv">Paulis</span><span class="w">      </span><span class="p">$</span><span class="nv">p</span><span class="o">/</span><span class="mi">15</span><span class="p">$</span><span class="w"> </span><span class="nv">each</span><span class="o">.</span>

<span class="w">   </span><span class="nv">Of</span><span class="w"> </span><span class="nv">those</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="nv">Paulis</span><span class="p">,</span><span class="w"> </span><span class="nv">exactly</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">three</span>
</code></pre></div>

<div class="arithmatex">\[
\{\,XX,\;YY,\;ZZ\,\}
\]</div>
<div class="codehilite"><pre><span></span><code>   commute with both stabilisers on that pair of qubits and are therefore
   {\it undetectable}; the remaining 12 are detected and the
   corresponding runs are discarded.
</code></pre></div>

<ol start="2">
<li>Undetectable errors and their action in the logical subspace<br />
    â€¢  For the <span class="arithmatex">\(CNOT_{21}\)</span> gate (qubits 2 &amp; 1) we have  </li>
</ol>
<div class="arithmatex">\[
XX_{21}=X_2X_1=X_A X_B,
\]</div>
<div class="arithmatex">\[
ZZ_{21}=Z_2Z_1=Z_A Z_B,
\]</div>
<div class="arithmatex">\[
YY_{21}=Y_2Y_1=i^2\,X_A X_B Z_A Z_B=Y_A Y_B,
\]</div>
<div class="codehilite"><pre><span></span><code>   up to an irrelevant overall phase.

â€¢  For the $CNOT_{03}$ gate (qubits 0 &amp; 3) the undetectable Paulis are
   related to the same logical operators by a stabiliser,
   e.g.
</code></pre></div>

<div class="arithmatex">\[
\]</div>
<div class="codehilite"><pre><span></span><code>   and similarly for $YY_{03}$.  
   Multiplying by a stabiliser does not change the encoded state.
</code></pre></div>

<ol start="3">
<li>Logical GHZ state is an eigenstate of the surviving logical Paulis<br />
    The target logical state  </li>
</ol>
<div class="arithmatex">\[
|\text{GHZ}\rangle_{AB}=\frac{|00\rangle_{AB}+|11\rangle_{AB}}{\sqrt2}
\]</div>
<div class="codehilite"><pre><span></span><code>is simultaneously a $+1$ eigenstate of
$X_A X_B,\;Z_A Z_B$, and of their product $Y_A Y_B$:
</code></pre></div>

<div class="arithmatex">\[
      Z_A Z_B|\text{GHZ}\rangle=|\text{GHZ}\rangle,\;
\]</div>
<div class="codehilite"><pre><span></span><code>where the $-$ sign for $Y_A Y_B$ is a global phase and hence physically
irrelevant.  Therefore {\it every undetectable error that survives
post-selection acts only by (at most) a global phase on the logical
state}.  The encoded state is unchanged.
</code></pre></div>

<ol start="4">
<li>Logical fidelity conditioned on successful post-selection<br />
    Because the post-selection discards all detectable errors and every
    remaining (undetectable) error leaves the logical state invariant, the
    conditional logical density operator equals the ideal projector:</li>
</ol>
<div class="arithmatex">\[
\rho_{\text{logical,\,post}}=|\text{GHZ}\rangle\langle\text{GHZ}|.
\]</div>
<div class="codehilite"><pre><span></span><code><span class="nv">Consequently</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">logical</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">fidelity</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">unity</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">any</span><span class="w"> </span><span class="nv">physical</span><span class="w"> </span><span class="nv">error</span>
<span class="nv">rate</span><span class="w"> </span>$<span class="nv">p</span>$,
</code></pre></div>

<div class="arithmatex">\[
F_{\text{logical}}(p)=\;1.
\]</div>
<p>Conventions and units:  Dimensionless probabilities; no numerical
approximation required.</p>
<p>Final Answer:<br />
After discarding all runs in which the [[4,2,2]] code detects an error, the 2-qubit logical state is {\it always} the intended<br />
<span class="arithmatex">\(\bigl(|00\rangle_{AB}+|11\rangle_{AB}\bigr)/\sqrt2\)</span>.  Hence  </p>
<div class="arithmatex">\[
F_{\rm logical}(p)=1\qquad\text{for all }p.
\]</div></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#5</span>
    </div>
    <div class="content markdown-body"><p>Populate your final answer into the code template provided below. This step is purely for formatting/display purposes. No additional reasoning or derivation should be performed. Do not import any modules or packages beyond what is provided in the template.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of the two-qubit gate error rate $p$ in Sympy format.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, the two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, the logical state fidelity as a function of $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># a SymPy expression of inputs</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#6</span>
    </div>
    <div class="content markdown-body"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of the two-qubit gate error rate $p$ in Sympy format.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, the two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, the logical state fidelity as a function of $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># a SymPy expression of inputs</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>

</div>

<footer>
  Generated at 2025-09-24T22:02:11.577105
</footer>

<script>
(function() {
  // Tabs
  const tabs = document.querySelectorAll('.tab');
  const panels = document.querySelectorAll('.tab-content');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      panels.forEach(p => p.classList.remove('active'));
      tab.classList.add('active');
      const target = document.querySelector(tab.dataset.target);
      if (target) target.classList.add('active');
    });
  });

  // Theme toggle
  const toggleBtn = document.getElementById('theme-toggle');
  function setTheme(dark) {
    if (dark) {
      document.documentElement.classList.add('dark');
      localStorage.setItem('dark', '1');
    } else {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('dark', '0');
    }
  }
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const stored = localStorage.getItem('dark');
  setTheme(stored === null ? prefersDark : stored === '1');

  toggleBtn.addEventListener('click', () => {
    const isDark = document.documentElement.classList.contains('dark');
    setTheme(!isDark);
  });
})();
</script>
</body>
</html>