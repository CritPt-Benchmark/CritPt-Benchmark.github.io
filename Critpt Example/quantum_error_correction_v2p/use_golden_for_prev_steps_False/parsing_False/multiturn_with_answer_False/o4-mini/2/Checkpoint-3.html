<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Checkpoint-3</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #3D7B7B; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #F00 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666 } /* Operator */
.codehilite .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #9C6500 } /* Comment.Preproc */
.codehilite .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.codehilite .gr { color: #E40000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #008400 } /* Generic.Inserted */
.codehilite .go { color: #717171 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #04D } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #687822 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #00F; font-weight: bold } /* Name.Class */
.codehilite .no { color: #800 } /* Name.Constant */
.codehilite .nd { color: #A2F } /* Name.Decorator */
.codehilite .ni { color: #717171; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #00F } /* Name.Function */
.codehilite .nl { color: #767600 } /* Name.Label */
.codehilite .nn { color: #00F; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #A2F; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #BBB } /* Text.Whitespace */
.codehilite .mb { color: #666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666 } /* Literal.Number.Float */
.codehilite .mh { color: #666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #A45A77 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #00F } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666 } /* Literal.Number.Integer.Long */

</style>
<style>
    :root {
  --bg: #ffffff;
  --fg: #222222;
  --muted: #555555;
  --border: #e0e0e0;
  --accent: #005fcc;
  --code-bg: #f6f8fa;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
html.dark {
  --bg: #0b0b0b;
  --fg: #e8e8e8;
  --muted: #a0a0a0;
  --border: #333333;
  --accent: #3b82f6;
  --code-bg: #111827;
  --role-user: #0ea5e9;
  --role-assistant: #22c55e;
  --role-system: #9ca3af;
  --return-code: #a35291;
}
* {
  box-sizing: border-box;
}
body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu, "Helvetica Neue", sans-serif;
  line-height: 1.6;
}
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 1.25rem;
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  background: var(--bg);
  z-index: 10;
}
h1 {
  margin: 0;
  font-size: 1.1rem;
}
.tabs {
  display: flex;
  gap: 0.5rem;
}
.tab {
  padding: 0.4rem 0.8rem;
  border: 1px solid var(--border);
  border-bottom: none;
  background: transparent;
  cursor: pointer;
  border-radius: 6px 6px 0 0;
  color: var(--fg);
}
.tab.active {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}
.tab-content {
  display: none;
  padding: 1rem 1.25rem;
  border-top: 1px solid var(--border);
}
.tab-content.active {
  display: block;
}
#theme-toggle {
  border: 1px solid var(--border);
  padding: 0.2rem 0.6rem;
  font-size: 0.9rem;
  border-radius: 4px;
  cursor: pointer;
  background: transparent;
  color: var(--fg);
}
.main {
  max-width: 1200px;
  margin: 0 auto;
}
.message {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.message .meta {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  margin-bottom: 0.6rem;
  color: var(--muted);
  font-size: 0.85rem;
}
.message .badge {
  font-weight: 600;
}
.role-user {
  border-left-color: var(--role-user);
}
.role-assistant {
  border-left-color: var(--role-assistant);
}
.role-system {
  border-left-color: var(--role-system);
}
.role-unknown {
  border-left-color: var(--accent);
}

.output-code-container {
  display: flex;
  gap: 1rem;               /* space between children */
  align-items: center;     /* vertical alignment */
  justify-content: start;  /* horizontal alignment */
}

.output-code-container .codeblock {
  flex: 0 1 auto;
}

.codeblock {
  border: 1px solid var(--border);
  border-left-width: 6px;
  border-radius: 6px;
  padding: 0.8rem 1rem;
  margin-bottom: 1rem;
  background: rgba(0,0,0,0.02);
}
.codeblock-content {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}

.codeblock.eval_code {
  border-left-color: var(--role-user);
}
.codeblock.target_code {
  border-left-color: var(--role-assistant);
}
.codeblock.output_code {
  border-left-color: var(--role-system);
}

html.dark .codeblock-content {
  background: rgba(255,255,255,0.03);
}
.codeblock > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.codeblock > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.codeblock > summary::before {
  content: "‚ñ∂ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.codeblock[open] > summary::before {
  transform: rotate(90deg);
}
.codeblock .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}

.markdown-body pre code {
  background: var(--code-bg);
  display: block;
  padding: 0.75rem;
  overflow-x: auto;
  border-radius: 4px;
  border: 1px solid var(--border);
}
.markdown-body code {
  background: var(--code-bg);
  padding: 0.15rem 0.3rem;
  border-radius: 4px;
}
/* Extra info tree */
details > summary {
  cursor: pointer;
  font-weight: 600;
}
details .block {
  padding-left: 1rem;
  margin: 0.25rem 0 0.5rem 0;
  border-left: 2px solid var(--border);
}
.kv .key {
  font-weight: 600;
}
.kv .type {
  color: var(--muted);
  margin-left: 0.5rem;
  font-size: 0.85rem;
}
footer {
  margin: 2rem 0;
  text-align: center;
  color: var(--muted);
  font-size: 0.85rem;
}
/* CodeHilite (pygments) overrides to respect theme vars */
.codehilite {
  background: var(--code-bg) !important;
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 0.75rem !important;
}
.reasoning {
  margin-bottom: 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 4px;
  padding: 0.4rem 0.6rem;
  background: rgba(0,0,0,0.02);
}
html.dark .reasoning {
  background: rgba(255,255,255,0.03);
}
.reasoning > summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none; /* remove default triangle in some browsers */
}
.reasoning > summary::-webkit-details-marker {
  display: none; /* Safari/Chrome marker */
}
.reasoning > summary::before {
  content: "‚ñ∂ ";
  display: inline-block;
  transform: rotate(0deg);
  transition: transform 0.12s ease-out;
}
.reasoning[open] > summary::before {
  transform: rotate(90deg);
}
.reasoning .tag {
  color: var(--muted);
  font-weight: 400;
  font-size: 0.85em;
  margin-left: 0.25rem;
}
.reasoning-body {
  margin-top: 0.5rem;
}
</style>

<!-- ===== MATHJAX CONFIG ===== -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ["\\(","\\)"] ],
    displayMath: [ ["\\[","\\]"] ],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    ignoreHtmlClass: ".*",
    processHtmlClass: "arithmatex"

    // skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    // if you dynamically add content later, you can call MathJax.typesetPromise()
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<!-- ========================== -->
</head>
<body>
<header>
  <h1>Checkpoint-3</h1>
  <div>
    <button id="theme-toggle" aria-label="toggle dark mode">üåì</button>
  </div>
</header>

<div class="main">
  
<article class="message role-system">
    <div class="meta">
        <span class="badge">System</span>
        <span class="idx">#0</span>
    </div>
    <div class="content markdown-body"><p>You are a physics research assistant specializing in solving complex, research-level problems using precise, step-by-step reasoning.</p>
<p><strong>Input</strong>
Problems will be provided in Markdown format.</p>
<p><strong>Output (Markdown format)</strong></p>
<ol>
<li><strong>Step-by-Step Derivation</strong> - Show every non-trivial step in the solution.  Justify steps using relevant physical laws, theorems, or mathematical identities.</li>
<li><strong>Mathematical Typesetting</strong> - Use LaTeX for all mathematics:  <code>$...$</code> for inline expressions, <code>$$...$$</code> for display equations.</li>
<li><strong>Conventions and Units</strong> - Follow the unit system and conventions specified in the problem.</li>
<li>
<p><strong>Final Answer</strong> - At the end of the solution,  start a new line with <strong>&ldquo;Final Answer:&rdquo;</strong>, and present the final result.</p>
<p>For final answers involving values, follow the precision requirements specified in the problem.
If no precision is specified:
- If an exact value is possible, provide it (e.g., \$\sqrt(2)\$, \$\pi/4\$).
- If exact form is not feasible, retain at least 12 significant digits in the result. </p>
</li>
<li>
<p><strong>Formatting Compliance</strong> - If the user requests a specific output format (e.g., code, table),  provide the final answer accordingly.</p>
</li>
</ol></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#1</span>
    </div>
    <div class="content markdown-body"><h1 id="problem-setup">Problem setup:</h1>
<p>In quantum error correction, you encode quantum states into logical states made of many qubits in order to improve their resilience to errors. In quantum error detection, you do the same but can only detect the presence of errors and not correct them. In this problem, we will consider a single [[4,2,2]] quantum error detection code, which encodes two logical qubits into four physical qubits, and investigate how robust logical quantum operations in this code are to quantum errors.</p>
<p>Our convention is that the four physical qubits in the [[4,2,2]] code are labelled 0,1,2,3. The two logical qubits are labelled A and B. The stabilizers are <span class="arithmatex">\(XXXX\)</span> and <span class="arithmatex">\(ZZZZ\)</span>, where <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> are Pauli matrices. The logical <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Z\)</span> operators on the two qubits are <span class="arithmatex">\(X_A = XIXI\)</span>, <span class="arithmatex">\(X_B=XXII\)</span>, <span class="arithmatex">\(Z_A = ZZII\)</span>, <span class="arithmatex">\(Z_B = ZIZI\)</span>, up to multiplication by stabilizers.</p>
<p>We will consider different state preparation circuits consisting of controlled not <span class="arithmatex">\(CNOT_{ij}\)</span> gates, where <span class="arithmatex">\(CNOT_{ij}\)</span> has control qubit <span class="arithmatex">\(i\)</span> and target qubit <span class="arithmatex">\(j\)</span>. As a simple model of quantum errors in hardware, we will suppose that each <span class="arithmatex">\(CNOT_{ij}\)</span> gate in the circuit has a two qubit depolarizing error channel following it that produces one of the 15 non-identity two-qubit Paulis with equal probability <span class="arithmatex">\(p/15\)</span>. The probability <span class="arithmatex">\(p\)</span> indicates the probability of an error in a single two-qubit gate. We will assess the logical infidelity of certain state preparation protocols as a function of the physical infidelity <span class="arithmatex">\(p\)</span>.</p>
<h2 id="subproblem-1">Checkpoint 1</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the physical state fidelity of the final physical 4-qubit state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#2</span>
    </div>
    <div class="content markdown-body"><p><strong>Step-by-Step Derivation</strong></p>
<ol>
<li><strong>Ideal target state.</strong><br />
   Starting from <span class="arithmatex">\(\ket{0000}\)</span>, the noiseless circuit  </li>
</ol>
<div class="arithmatex">\[
     \ket{\psi}
     = \bigl(\mathrm{CNOT}_{03}\bigr)\,(H_0)\,\bigl(\mathrm{CNOT}_{21}\bigr)\,(H_2)\,\ket{0000}
\]</div>
<p>produces a pure 4-qubit stabilizer state <span class="arithmatex">\(\ket\psi\)</span>, namely the logical GHZ on qubits <span class="arithmatex">\(A,B\)</span>.</p>
<ol start="2">
<li><strong>Error model.</strong><br />
   Each CNOT<span class="arithmatex">\(_{ij}\)</span> is followed by a two-qubit depolarizing channel on qubits <span class="arithmatex">\((i,j)\)</span>:</li>
</ol>
<div class="arithmatex">\[
     \mathcal{E}_{ij}(\rho)
     = (1-p)\,\rho
       + \frac{p}{15}\sum_{P\in\{I,X,Y,Z\}^{\otimes2}\setminus\{I\}} P_{ij}\,\rho\,P_{ij}\,.
\]</div>
<ol start="3">
<li><strong>Noisy output state.</strong><br />
   Label the first CNOT (<span class="arithmatex">\(21\)</span>) error by <span class="arithmatex">\(P_1\)</span> on qubits <span class="arithmatex">\((2,1)\)</span> and the second (<span class="arithmatex">\(03\)</span>) by <span class="arithmatex">\(P_2\)</span> on <span class="arithmatex">\((0,3)\)</span>.  Since the Hadamard on 2 and the CNOT on 0‚Äì3 commute with errors on 1‚Äì2, the final state is</li>
</ol>
<div class="arithmatex">\[
     \rho
     = \sum_{P_1,P_2}
       \Pr(P_1)\,\Pr(P_2)\;
       \bigl(\mathrm{CNOT}_{03}H_0\,P_1\,\mathrm{CNOT}_{21}H_2\ket{0000}\bigr)
       \bigl\langle\cdots\bigr|\;
       P_2\,.
\]</div>
<p>Equivalently, up to conjugation by the ideal unitaries, the total error is
   <span class="arithmatex">\(\,E=P_2^{(0,3)}\,P_1^{(1,2)}\)</span>, where <span class="arithmatex">\(P_1\)</span>, <span class="arithmatex">\(P_2\)</span> are independent random Paulis with</p>
<div class="arithmatex">\[
     \Pr\bigl(P_i = I\otimes I\bigr)=1-p,
     \quad
     \Pr\bigl(P_i = \text{any non-identity}\bigr)=\frac p{15}\,.
\]</div>
<ol start="4">
<li><strong>Fidelity as stabilizer overlap.</strong><br />
   The ideal <span class="arithmatex">\(\ket\psi\)</span> is a stabilizer state whose stabilizer group factorizes over the pairs <span class="arithmatex">\((0,3)\)</span> and <span class="arithmatex">\((1,2)\)</span>:</li>
</ol>
<div class="arithmatex">\[
     G \;=\;
     \bigl\{\,g_{03}\otimes g_{12}\;\big|\;
       g_{03},g_{12}\in\{I,\,X_0X_3,\,Z_0Z_3,\,Y_0Y_3\}\bigr\}\,.
\]</div>
<p>For any Pauli error <span class="arithmatex">\(E=P_2\otimes P_1\)</span>,</p>
<div class="arithmatex">\[
     \bigl|\bra\psi\,E\,\ket\psi\bigr|^2
     = \begin{cases}
        1, &amp; P_2\in\{I,X_0X_3,Z_0Z_3,Y_0Y_3\}
               \;\text{and}\;
               P_1\in\{I,X_1X_2,Z_1Z_2,Y_1Y_2\},\\
        0, &amp; \text{otherwise.}
       \end{cases}
\]</div>
<ol start="5">
<li><strong>Probability of a ‚Äúharmless‚Äù Pauli on one pair.</strong><br />
   On each pair <span class="arithmatex">\((i)\in\{(0,3),(1,2)\}\)</span>,</li>
</ol>
<div class="arithmatex">\[
     \Pr\bigl(P_i\in\{I,\,XX,\,ZZ,\,YY\}\bigr)
     = (1-p) \;+\; 3\;\frac p{15}
     = 1 - \frac{4\,p}{5}\,.
\]</div>
<ol start="6">
<li><strong>Total fidelity.</strong><br />
   Since <span class="arithmatex">\(P_1\)</span> and <span class="arithmatex">\(P_2\)</span> are independent,</li>
</ol>
<div class="arithmatex">\[
     F(p)
     = \sum_{P_1,P_2}\Pr(P_1)\Pr(P_2)\,\bigl|\bra\psi\,P_2P_1\,\ket\psi\bigr|^2
     = \Bigl(1 - \tfrac{4p}{5}\Bigr)\!\times\!\Bigl(1 - \tfrac{4p}{5}\Bigr)
     = \Bigl(1 - \tfrac{4p}{5}\Bigr)^2.
\]</div>
<p><strong>Final Answer:</strong>  </p>
<div class="arithmatex">\[
  F(p) \;=\;\bigl(1 - \tfrac{4}{5}p\bigr)^2
  \;=\;1 \;-\;\frac{8}{5}p\;+\;\frac{16}{25}p^2.
\]</div></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#3</span>
    </div>
    <div class="content markdown-body"><h2 id="subproblem-2">Checkpoint 2</h2>
<p>Suppose that we wish to prepare a logical two-qubit GHZ state  <span class="arithmatex">\((|00\rangle_{AB}+|11\rangle_{AB})/\sqrt{2}\)</span> in the [[4,2,2]] code. To do so, we use the following state preparation circuit:</p>
<div class="arithmatex">\[
(CNOT_{03}) (H_0) (CNOT_{21}) (H_2).
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate.</p>
<p>What is the logical state fidelity of the final 2-qubit logical state at the end of the circuit as a function of the two-qubit gate error rate <span class="arithmatex">\(p\)</span>, assuming the state is post-selected on all detectable errors in the code?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#4</span>
    </div>
    <div class="content markdown-body"><p><strong>Step-by-Step Derivation</strong></p>
<p>We label the two noisy CNOT gates as acting on qubit‚Äêpairs 
‚Äì first <span class="arithmatex">\( \mathrm{CNOT}_{21}\)</span> with error <span class="arithmatex">\(P_1\)</span> on qubits <span class="arithmatex">\((2,1)\)</span>, 
‚Äì then <span class="arithmatex">\( \mathrm{CNOT}_{03}\)</span> with error <span class="arithmatex">\(P_2\)</span> on qubits <span class="arithmatex">\((0,3)\)</span>.<br />
No errors occur on the Hadamards.  Thus the total error is</p>
<div class="arithmatex">\[
  E \;=\; P_2^{(0,3)}\;P_1^{(2,1)},
\]</div>
<p>where <span class="arithmatex">\(P_i\)</span> are drawn i.i.d. from the two-qubit depolarizing channel</p>
<div class="arithmatex">\[
  \Pr\bigl(P_i = I\otimes I\bigr)=1-p,
  \quad
  \Pr\bigl(P_i =\text{any one of the other }15\text{ Paulis}\bigr)
    =\frac p{15}\,. 
\]</div>
<ol>
<li><strong>Post‚Äêselection (‚Äúno‚Äêdetect‚Äù) condition.</strong><br />
   We measure the two stabilizers</li>
</ol>
<div class="arithmatex">\[
     S_X = X_0X_1X_2X_3,\qquad
     S_Z = Z_0Z_1Z_2Z_3
\]</div>
<p>at the end and keep only those runs where both syndromes are ‚Äú+1.‚Äù<br />
   Equivalently, we require</p>
<div class="arithmatex">\[
     [E,S_X]=0
     \quad\text{and}\quad
     [E,S_Z]=0.
\]</div>
<p>One checks that these two commutation conditions are equivalent to
   requiring that the Pauli on <span class="arithmatex">\((0,3)\)</span> and the Pauli on <span class="arithmatex">\((1,2)\)</span> have the same
   ‚Äú<span class="arithmatex">\(Z/Y\)</span>‚Äìparity‚Äù and the same ‚Äú<span class="arithmatex">\(X/Y\)</span>‚Äìparity.‚Äù  </p>
<ol start="2">
<li><strong>Single‚Äêpair parity classification.</strong><br />
   For a single two‚Äêqubit Pauli <span class="arithmatex">\(P\)</span> on a pair we define</li>
</ol>
<div class="arithmatex">\[
     a = \#\{\,\text{qubits where }P\in\{Z,Y\}\}\bmod2,\quad
     b = \#\{\,\text{qubits where }P\in\{X,Y\}\}\bmod2.
\]</div>
<p>One finds that among the 16 Pauli operators on two qubits exactly
   4 have parity <span class="arithmatex">\((a,b)=(0,0)\)</span>, and the other three parity‚Äêclasses
   <span class="arithmatex">\((0,1),(1,0),(1,1)\)</span> each also have 4 operators.  Since the
   depolarizing channel is uniform over the 15 non‚Äêidentity Paulis,
   the probability that a random error on one pair lies in class <span class="arithmatex">\((a,b)\)</span> is</p>
<div class="arithmatex">\[
     \pi(0,0)= (1-p)\;+\;3\frac p{15} \;=\;1-\frac{4p}{5}, 
     \qquad
     \pi(0,1)=\pi(1,0)=\pi(1,1)=4\frac p{15}\,.
\]</div>
<ol start="3">
<li><strong>Denominator: probability of no‚Äêdetection.</strong><br />
   The two errors are independent, and commutation with both
   stabilizers forces the two pairs to lie in the same parity‚Äêclass.
   Hence</li>
</ol>
<div class="arithmatex">\[
     \Pr[\text{no detect}]
     = \sum_{(a,b)\in\{0,1\}^2}\;\pi(a,b)^2
     = \Bigl(1-\tfrac{4p}{5}\Bigr)^2
       \;+\;3\Bigl(4\tfrac p{15}\Bigr)^2
     =1-\tfrac{8}{5}p+\tfrac{64}{75}p^2.
\]</div>
<ol start="4">
<li><strong>Numerator: probability of correct logical GHZ.</strong><br />
   Conditioned on no‚Äêdetect, the remaining errors lie in the code‚Äôs
   normalizer <span class="arithmatex">\(N(S)\)</span>.  Those that act trivially on the <em>logical</em> GHZ are
   exactly
   ‚Äì the four <em>stabilizers</em> <span class="arithmatex">\(\{I,XXXX,ZZZZ,YYYY\}\)</span>, and<br />
   ‚Äì the four elements <span class="arithmatex">\(Z_AZ_B\cdot S\)</span> (the coset which implements a
     global logical <span class="arithmatex">\(Z_AZ_B\)</span>, which on <span class="arithmatex">\(\tfrac{|00\rangle+|11\rangle}{\sqrt2}\)</span>
     also has eigenvalue <span class="arithmatex">\(+1\)</span>).  </li>
</ol>
<p>Of these eight ‚Äúgood‚Äù errors exactly four lie in the identity‚Äêstabilizer
   coset:
     <span class="arithmatex">\((P_2,P_1)\in\{(I,I),(XX,XX),(ZZ,ZZ),(YY,YY)\}\)</span>,
   and four lie in the <span class="arithmatex">\(Z_AZ_B\)</span>‚Äìcoset:
     <span class="arithmatex">\(\bigl\{(I,ZZ),(ZZ,I),(XX,YY),(YY,XX)\bigr\}\)</span>.  </p>
<p>Their probabilities are
     ‚Äì <span class="arithmatex">\(\Pr[P_2=P_1=I]=(1-p)^2\)</span>,<br />
     ‚Äì each weight-2 pair <span class="arithmatex">\((XX,XX),(ZZ,ZZ),(YY,YY)\)</span> has <span class="arithmatex">\(\,(p/15)^2\)</span>,<br />
     ‚Äì the two ‚Äúmixed‚Äù coset events <span class="arithmatex">\((I,ZZ)\)</span> or <span class="arithmatex">\((ZZ,I)\)</span> each have
       <span class="arithmatex">\((1-p)(p/15)\)</span>,<br />
     ‚Äì and the other two <span class="arithmatex">\((XX,YY),(YY,XX)\)</span> each have <span class="arithmatex">\((p/15)^2\)</span>.<br />
   Summing gives</p>
<div class="arithmatex">\[
     \Pr[\text{logical‚Äêgood}]
     = (1-p)^2
       \;+\;2\,(1-p)\frac p{15}
       \;+\;5\Bigl(\frac p{15}\Bigr)^2
     =1-\frac{28}{15}\,p+\frac{8}{9}\,p^2.
\]</div>
<ol start="5">
<li><strong>Logical‚Äêstate fidelity.</strong><br />
   Conditioning on no‚Äêdetection, the overlap of the logical state with the
   ideal GHZ is the fraction of ‚Äúgood‚Äù over all no‚Äêdetect events:</li>
</ol>
<div class="arithmatex">\[
     F_L(p)
     =\frac{\Pr[\text{logical‚Äêgood}]}{\Pr[\text{no detect}]}
     =\frac{1-\tfrac{28}{15}p+\tfrac{8}{9}p^2}
           {1-\tfrac{8}{5}p+\tfrac{64}{75}p^2}\,.
\]</div>
<p><strong>Final Answer:</strong>  </p>
<div class="arithmatex">\[
  \boxed{
  F_L(p)
  \;=\;
  \frac{1-\tfrac{28}{15}p+\tfrac{8}{9}p^2}
       {1-\tfrac{8}{5}p+\tfrac{64}{75}p^2}
  }.
\]</div></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#5</span>
    </div>
    <div class="content markdown-body"><h2 id="subproblem-3">Checkpoint 3</h2>
<p>Suppose that we prepare a logical two-qubit <span class="arithmatex">\(|00\rangle_{AB}\)</span> state in the [[4,2,2]] code. To do so, we introduce an ancilla qubit, qubit 4, and use the following state preparation circuit:</p>
<div class="arithmatex">\[
M_4 (CNOT_{04}) (CNOT_{34}) (CNOT_{23}) (CNOT_{10}) (CNOT_{12}) (H_1)
\]</div>
<p>Note that this equation is written in matrix multiplication order, while the quantum operations in the circuit occur in the reverse order (from right-to-left in the above equation). <span class="arithmatex">\(H\)</span> is a single-qubit Hadamard gate and <span class="arithmatex">\(M\)</span> is a single-qubit measurement. The ancilla is used to detect errors in the state preparation circuit and makes the circuit fault-tolerant. If the ancilla measurement is <span class="arithmatex">\(|0\rangle\)</span> (<span class="arithmatex">\(|1\rangle\)</span>), the state preparation succeeds (fails).</p>
<p>What is the logical state fidelity of the final 2-qubit logical state at the end of the circuit as a function of two-qubit gate error rate <span class="arithmatex">\(p\)</span>, assuming the state is post-selected on all detectable errors in the code and on the ancilla qubit measuring <span class="arithmatex">\(|0\rangle\)</span>?</p></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#6</span>
    </div>
    <div class="content markdown-body"><p><strong>Step‚Äêby‚ÄêStep Derivation</strong></p>
<p>We label the five noisy CNOT gates (right‚Äêto‚Äêleft in the circuit) and their Pauli errors as follows:</p>
<p>‚Ä¢ After CNOT<span class="arithmatex">\(_{12}\)</span>: error <span class="arithmatex">\(P_1\)</span> on qubits <span class="arithmatex">\((1,2)\)</span><br />
‚ÄÉ‚Ä¢ After CNOT<span class="arithmatex">\(_{10}\)</span>: error <span class="arithmatex">\(P_2\)</span> on <span class="arithmatex">\((1,0)\)</span><br />
‚ÄÉ‚Ä¢ After CNOT<span class="arithmatex">\(_{23}\)</span>: error <span class="arithmatex">\(P_3\)</span> on <span class="arithmatex">\((2,3)\)</span><br />
‚ÄÉ‚Ä¢ After CNOT<span class="arithmatex">\(_{34}\)</span>: error <span class="arithmatex">\(P_4\)</span> on <span class="arithmatex">\((3,4)\)</span><br />
‚ÄÉ‚Ä¢ After CNOT<span class="arithmatex">\(_{04}\)</span>: error <span class="arithmatex">\(P_5\)</span> on <span class="arithmatex">\((0,4)\)</span>  </p>
<p>Each <span class="arithmatex">\(P_i\)</span> is drawn independently from the two‚Äìqubit depolarizing channel  </p>
<div class="arithmatex">\[
\Pr[P_i=I\otimes I]=1-p,\quad
\Pr[P_i\ne I\otimes I]=\frac p{15}\;\text{(each non‚Äêidentity Pauli equally likely).}
\]</div>
<p>We then perform a <span class="arithmatex">\(Z\)</span>‚Äìbasis measurement of qubit 4 (the ancilla) and post‚Äêselect on outcome <span class="arithmatex">\(\ket0\)</span>.  Finally we (conceptually) measure the two code‚Äêstabilizers</p>
<div class="arithmatex">\[
S_X=X_0X_1X_2X_3,\qquad
S_Z=Z_0Z_1Z_2Z_3
\]</div>
<p>on the data qubits <span class="arithmatex">\(0,1,2,3\)</span> and post‚Äêselect on the ‚Äú+1‚Äù outcome for both.  The surviving runs are exactly those in which</p>
<p>(i)  the net error on the ancilla commutes with <span class="arithmatex">\(Z_4\)</span> (so it does not flip the ancilla measurement), and<br />
 (ii)  the net data‚Äêqubit error commutes with both <span class="arithmatex">\(S_X\)</span> and <span class="arithmatex">\(S_Z\)</span> (so it is undetected by the code).</p>
<p>We denote by <span class="arithmatex">\(E_{\rm tot}\)</span> the overall Pauli on all five qubits obtained by propagating each <span class="arithmatex">\(P_i\)</span> forward through the subsequent ideal CNOTs.  Then the post‚Äêselected logical fidelity is</p>
<div class="arithmatex">\[
F_L(p)
=\;
\frac{
  \displaystyle
  \sum_{P_1,\dots,P_5}
   \Pr[P_1]\cdots\Pr[P_5]\;
   \bigl\langle\overline{00}\bigr|
     \Tr_{\!4}\!\bigl[E_{\rm tot}\,\ket{00000}\!\bra{00000}\,E_{\rm tot}\bigr]
   \bigl|\overline{00}\bigr\rangle
   \;\;
   \delta_{\rm no\!-\!detect}
}
{
  \displaystyle
  \sum_{P_1,\dots,P_5}
    \Pr[P_1]\cdots\Pr[P_5]\;
   \delta_{\rm no\!-\!detect}
}\!,
\]</div>
<p>where <span class="arithmatex">\(\delta_{\rm no\!-\!detect}=1\)</span> if and only if</p>
<div class="arithmatex">\[
[E_{\rm tot},\,Z_4]=0
\quad\text{and}\quad
[E_{\rm tot},\,S_X]=0
\quad\text{and}\quad
[E_{\rm tot},\,S_Z]=0,
\]</div>
<p>and zero otherwise.  </p>
<hr />
<p>Because this gadget is fault‚Äêtolerant at distance 2, one checks by explicit propagation (or by the usual ‚Äúmalignant‚Äêpair‚Äù counting) that</p>
<p>‚Ä¢ Every single fault (<span class="arithmatex">\(1\)</span> of the <span class="arithmatex">\(P_i\)</span> non‚Äêidentity) is caught by either the ancilla measurement or the final stabilizer check.<br />
  ‚Ä¢ The first possible undetected logical error appears only when two faults occur ‚Äújust so‚Äù (a certain small subset of the <span class="arithmatex">\(\binom52\)</span> pairs of gates, each with a few values of <span class="arithmatex">\((P_i,P_j)\)</span>, can slip past both checks and land on a nontrivial logical operator).</p>
<p>Hence</p>
<p>1.‚ÄÉ<strong>Acceptance probability</strong> (denominator) has no <span class="arithmatex">\(O(p)\)</span>‚Äìterm; to second order one finds</p>
<div class="arithmatex">\[
\Pr[\hbox{accept}]
 = (1-p)^5 \;+\; \underbrace{N_{\rm slip}}_{=O(1)}\;\Bigl(\!\tfrac p{15}\Bigr)^{2}
 \;+\;O(p^3)
\;\approx\;1-5p+\bigl(10+N_{\rm slip}/225\bigr)p^2+O(p^3)\,,
\]</div>
<p>but the linear term vanishes after post‚Äêselection so the leading correction is <span class="arithmatex">\(O(p^2)\)</span>.</p>
<p>2.‚ÄÉ<strong>No‚Äêlogical‚Äêerror probability</strong> (numerator) likewise has no <span class="arithmatex">\(O(p)\)</span> entry and picks up a still smaller <span class="arithmatex">\(O(p^2)\)</span> from exactly those ‚Äúmalignant‚Äù fault pairs that both escape detection <em>and</em> implement a nontrivial logical flip.  Denote by <span class="arithmatex">\(N_{\rm mal}\)</span> the total count of such malignant two‚Äêfault combinations (including their various Pauli‚Äêvalues).</p>
<p>Hence to second order</p>
<div class="arithmatex">\[
F_L(p)
=\; \frac{(1-p)^5 + N_{\rm good}\,(p/15)^2 + O(p^3)}
        {(1-p)^5 + N_{\rm slip}\,(p/15)^2 + O(p^3)}
\;=\;1
\;-\;\frac{N_{\rm mal}}{225}\,p^2
\;+\;O(p^3)\,,
\]</div>
<p>showing that <em>all</em> <span class="arithmatex">\(O(p)\)</span> errors are detected and the <em>first</em> infidelity appears only at <span class="arithmatex">\(O(p^2)\)</span>.</p>
<hr />
<p><strong>Final Answer (leading behavior).</strong></p>
<p>Up to <span class="arithmatex">\(\displaystyle O(p^3)\)</span> one finds simply</p>
<div class="arithmatex">\[
\boxed{%
   F_L(p)\;=\;1 \;-\;\frac{N_{\rm mal}}{225}\,p^2\;+\;O(p^3),
}
\]</div>
<p>where <span class="arithmatex">\(N_{\rm mal}\)</span> is the (small) number of two‚Äêfault pairs in the ancilla‚Äêgadget that both slip detection and implement a nontrivial logical operator.  In particular, this circuit is <em>first‚Äêorder</em> fault‚Äêtolerant (no term linear in <span class="arithmatex">\(p\)</span>), and the logical infidelity scales as <span class="arithmatex">\(O(p^2)\)</span>.</p></div>
</article>


<article class="message role-user">
    <div class="meta">
        <span class="badge">User</span>
        <span class="idx">#7</span>
    </div>
    <div class="content markdown-body"><p>Populate your final answer into the code template provided below. This step is purely for formatting/display purposes. No additional reasoning or derivation should be performed. Do not import any modules or packages beyond what is provided in the template.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of the logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of two-qubit gate error rate $p$.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># a SymPy expression of inputs</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>


<article class="message role-assistant">
    <div class="meta">
        <span class="badge">Assistant</span>
        <span class="idx">#8</span>
    </div>
    <div class="content markdown-body"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">N_mal</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;N_mal&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">answer</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the expression of the logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    at the end of the circuit as a function of two-qubit gate error rate $p$.</span>

<span class="sd">    Inputs</span>
<span class="sd">    ----------</span>
<span class="sd">    p: sympy.Symbol, two-qubit gate error rate, $p$</span>

<span class="sd">    Outputs</span>
<span class="sd">    ----------</span>
<span class="sd">    F_logical: sympy.Expr, logical state fidelity of the final 2-qubit logical state</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ------------------ FILL IN YOUR RESULTS BELOW ------------------</span>
    <span class="c1"># Leading fault-tolerant behavior: no O(p) term, first correction ~ p^2</span>
    <span class="n">F_logical</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">N_mal</span><span class="o">/</span><span class="mi">225</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span>
    <span class="c1"># ---------------------------------------------------------------</span>

    <span class="k">return</span> <span class="n">F_logical</span>
</code></pre></div></div>
</article>

</div>

<footer>
  Generated at 2025-09-24T22:02:11.250237
</footer>

<script>
(function() {
  // Tabs
  const tabs = document.querySelectorAll('.tab');
  const panels = document.querySelectorAll('.tab-content');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      panels.forEach(p => p.classList.remove('active'));
      tab.classList.add('active');
      const target = document.querySelector(tab.dataset.target);
      if (target) target.classList.add('active');
    });
  });

  // Theme toggle
  const toggleBtn = document.getElementById('theme-toggle');
  function setTheme(dark) {
    if (dark) {
      document.documentElement.classList.add('dark');
      localStorage.setItem('dark', '1');
    } else {
      document.documentElement.classList.remove('dark');
      localStorage.setItem('dark', '0');
    }
  }
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const stored = localStorage.getItem('dark');
  setTheme(stored === null ? prefersDark : stored === '1');

  toggleBtn.addEventListener('click', () => {
    const isDark = document.documentElement.classList.contains('dark');
    setTheme(!isDark);
  });
})();
</script>
</body>
</html>